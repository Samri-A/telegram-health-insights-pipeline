[0m22:48:30.291652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC60F74AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC61FBFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC61FBF9D0>]}


============================== 22:48:30.301260 | 0b1e985f-1768-4625-87a1-41eb8008ce03 ==============================
[0m22:48:30.301260 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:48:30.302116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt init', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:49:35.664483 [debug] [MainThread]: Starter project path: C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\env\Lib\site-packages\dbt\include\starter_project
[0m22:49:35.735239 [info ] [MainThread]: 
Your new dbt project "Med_analytics" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m22:49:35.736239 [info ] [MainThread]: Setting up your profile.
[0m22:51:10.351234 [info ] [MainThread]: Profile Med_analytics written to C:\Users\HP\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m22:51:10.354404 [debug] [MainThread]: Command `dbt init` succeeded at 22:51:10.354083 after 160.22 seconds
[0m22:51:10.355344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC630FFCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC63131370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC63039AE0>]}
[0m22:51:10.356376 [debug] [MainThread]: Flushing usage events
[0m22:51:12.590926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:51:21.125004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BC91A4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BCB2BFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BCB2BF9D0>]}


============================== 22:51:21.135702 | 02910963-a8dd-4293-91d8-1bbc148674f3 ==============================
[0m22:51:21.135702 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:51:21.136623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt init', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:51:28.883992 [debug] [MainThread]: Starter project path: C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\env\Lib\site-packages\dbt\include\starter_project
[0m22:51:28.907898 [info ] [MainThread]: 
Your new dbt project "Med_analtics" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m22:51:28.908608 [info ] [MainThread]: Setting up your profile.
[0m22:52:24.453354 [info ] [MainThread]: Profile Med_analtics written to C:\Users\HP\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m22:52:24.457011 [debug] [MainThread]: Command `dbt init` succeeded at 22:52:24.456611 after 63.56 seconds
[0m22:52:24.458056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BCB32FA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BCB361370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BCA171AE0>]}
[0m22:52:24.459215 [debug] [MainThread]: Flushing usage events
[0m22:52:25.529086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:22:20.344051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AA0CA4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AA1CEFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AA1CEF9D0>]}


============================== 23:22:20.408181 | be0e7c14-6874-4c81-ad85-423c39dfe413 ==============================
[0m23:22:20.408181 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:22:20.412274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:24:43.830725 [debug] [MainThread]: Starter project path: C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\env\Lib\site-packages\dbt\include\starter_project
[0m23:24:43.915528 [info ] [MainThread]: 
Your new dbt project "med_insights" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m23:24:43.917608 [info ] [MainThread]: Setting up your profile.
[0m23:25:55.353204 [info ] [MainThread]: Profile med_insights written to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m23:25:55.357355 [debug] [MainThread]: Command `dbt init` succeeded at 23:25:55.356927 after 215.66 seconds
[0m23:25:55.358542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AA2E2FA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AA2E61370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AA2D6DAE0>]}
[0m23:25:55.359629 [debug] [MainThread]: Flushing usage events
[0m23:25:56.909628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:30.345072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CB494AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CC4E3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CC4E39D0>]}


============================== 23:26:30.382668 | 820017d4-c67e-4574-a0c1-8a5f0b5bd0c0 ==============================
[0m23:26:30.382668 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:26:30.386044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:26:30.571808 [info ] [MainThread]: dbt version: 1.10.4
[0m23:26:30.576102 [info ] [MainThread]: python version: 3.13.5
[0m23:26:30.579699 [info ] [MainThread]: python path: C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\env\Scripts\python.exe
[0m23:26:30.590425 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m23:26:30.836523 [info ] [MainThread]: Using profiles dir at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt
[0m23:26:30.838178 [info ] [MainThread]: Using profiles.yml file at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\profiles.yml
[0m23:26:30.839440 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\dbt_project.yml
[0m23:26:30.840947 [info ] [MainThread]: Configuration:
[0m23:26:30.842091 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m23:26:30.843724 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m23:26:30.845678 [info ] [MainThread]: Required dependencies:
[0m23:26:30.847088 [debug] [MainThread]: Executing "git --help"
[0m23:26:31.017492 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:26:31.020852 [debug] [MainThread]: STDERR: "b''"
[0m23:26:31.023392 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:26:31.026299 [info ] [MainThread]: Connection test skipped since no profile was found
[0m23:26:31.029314 [info ] [MainThread]: [31m2 checks failed:[0m
[0m23:26:31.032040 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "Medical_analysis", target "dev" invalid: 1997 is not of type 'string'


[0m23:26:31.036196 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\dbt_project.yml> not found

[0m23:26:31.046794 [debug] [MainThread]: Command `dbt debug` failed at 23:26:31.045536 after 1.16 seconds
[0m23:26:31.049999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CD7788A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CD76AC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CD6A06B0>]}
[0m23:26:31.054068 [debug] [MainThread]: Flushing usage events
[0m23:26:32.255181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:27:51.241165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026010E34AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026012F4FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026012F4F9D0>]}


============================== 23:27:51.273801 | d5d5994e-e23e-46c2-a546-52e6ce618309 ==============================
[0m23:27:51.273801 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:27:51.276596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:27:51.384781 [info ] [MainThread]: dbt version: 1.10.4
[0m23:27:51.386351 [info ] [MainThread]: python version: 3.13.5
[0m23:27:51.387910 [info ] [MainThread]: python path: C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\env\Scripts\python.exe
[0m23:27:51.390283 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m23:27:51.701574 [info ] [MainThread]: Using profiles dir at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt
[0m23:27:51.703679 [info ] [MainThread]: Using profiles.yml file at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\profiles.yml
[0m23:27:51.705342 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\dbt_project.yml
[0m23:27:51.707180 [info ] [MainThread]: Configuration:
[0m23:27:51.708788 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m23:27:51.710840 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m23:27:51.712146 [info ] [MainThread]: Required dependencies:
[0m23:27:51.713856 [debug] [MainThread]: Executing "git --help"
[0m23:27:51.832570 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:27:51.834282 [debug] [MainThread]: STDERR: "b''"
[0m23:27:51.835861 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:27:51.837804 [info ] [MainThread]: Connection test skipped since no profile was found
[0m23:27:51.839758 [info ] [MainThread]: [31m2 checks failed:[0m
[0m23:27:51.841554 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "Medical_analysis", target "dev" invalid: 1997 is not of type 'string'


[0m23:27:51.843809 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\dbt_project.yml> not found

[0m23:27:51.851191 [debug] [MainThread]: Command `dbt debug` failed at 23:27:51.850360 after 0.97 seconds
[0m23:27:51.854008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260132048A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260131F6C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601303C6B0>]}
[0m23:27:51.856789 [debug] [MainThread]: Flushing usage events
[0m23:27:53.133876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:28:50.791944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E41474AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E424C3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E424C39D0>]}


============================== 23:28:50.813635 | 14407a7f-d7d6-404e-ac3b-68d44a803aeb ==============================
[0m23:28:50.813635 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:28:50.815467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:28:50.908634 [info ] [MainThread]: dbt version: 1.10.4
[0m23:28:50.910782 [info ] [MainThread]: python version: 3.13.5
[0m23:28:50.912967 [info ] [MainThread]: python path: C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\env\Scripts\python.exe
[0m23:28:50.916733 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m23:28:51.226875 [info ] [MainThread]: Using profiles dir at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt
[0m23:28:51.228527 [info ] [MainThread]: Using profiles.yml file at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\profiles.yml
[0m23:28:51.230210 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\dbt_project.yml
[0m23:28:51.232054 [info ] [MainThread]: Configuration:
[0m23:28:51.233109 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m23:28:51.234411 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m23:28:51.235724 [info ] [MainThread]: Required dependencies:
[0m23:28:51.236748 [debug] [MainThread]: Executing "git --help"
[0m23:28:51.347240 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:28:51.348582 [debug] [MainThread]: STDERR: "b''"
[0m23:28:51.349735 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:28:51.351276 [info ] [MainThread]: Connection test skipped since no profile was found
[0m23:28:51.352905 [info ] [MainThread]: [31m2 checks failed:[0m
[0m23:28:51.354272 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "Medical_analysis", target "dev" invalid: 1997 is not of type 'string'


[0m23:28:51.355626 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  dbt_project.yml does not parse to a dictionary


[0m23:28:51.359900 [debug] [MainThread]: Command `dbt debug` failed at 23:28:51.359407 after 0.94 seconds
[0m23:28:51.361307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E437548A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E4374AC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E436806B0>]}
[0m23:28:51.363233 [debug] [MainThread]: Flushing usage events
[0m23:28:52.628414 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:41.806898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E0094AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E21AFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E21AF9D0>]}


============================== 23:31:41.831036 | bcfd0910-33b2-4e43-abf3-cd4eef6199ca ==============================
[0m23:31:41.831036 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:31:41.833123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:41.963914 [info ] [MainThread]: dbt version: 1.10.4
[0m23:31:41.967780 [info ] [MainThread]: python version: 3.13.5
[0m23:31:41.972498 [info ] [MainThread]: python path: C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\env\Scripts\python.exe
[0m23:31:41.978474 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m23:31:42.382679 [info ] [MainThread]: Using profiles dir at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt
[0m23:31:42.384061 [info ] [MainThread]: Using profiles.yml file at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\profiles.yml
[0m23:31:42.385227 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\dbt_project.yml
[0m23:31:42.389659 [info ] [MainThread]: adapter type: postgres
[0m23:31:42.390852 [info ] [MainThread]: adapter version: 1.9.0
[0m23:31:42.868608 [info ] [MainThread]: Configuration:
[0m23:31:42.870281 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:31:42.871938 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:31:42.873596 [info ] [MainThread]: Required dependencies:
[0m23:31:42.875587 [debug] [MainThread]: Executing "git --help"
[0m23:31:43.004659 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:31:43.006791 [debug] [MainThread]: STDERR: "b''"
[0m23:31:43.008902 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:31:43.011128 [info ] [MainThread]: Connection:
[0m23:31:43.013344 [info ] [MainThread]:   host: localhost
[0m23:31:43.015294 [info ] [MainThread]:   port: 5432
[0m23:31:43.017466 [info ] [MainThread]:   user: postgres
[0m23:31:43.019904 [info ] [MainThread]:   database: Tg_med
[0m23:31:43.022670 [info ] [MainThread]:   schema: Raw
[0m23:31:43.025654 [info ] [MainThread]:   connect_timeout: 10
[0m23:31:43.027945 [info ] [MainThread]:   role: None
[0m23:31:43.030596 [info ] [MainThread]:   search_path: None
[0m23:31:43.032650 [info ] [MainThread]:   keepalives_idle: 0
[0m23:31:43.034930 [info ] [MainThread]:   sslmode: None
[0m23:31:43.037452 [info ] [MainThread]:   sslcert: None
[0m23:31:43.040988 [info ] [MainThread]:   sslkey: None
[0m23:31:43.043730 [info ] [MainThread]:   sslrootcert: None
[0m23:31:43.046118 [info ] [MainThread]:   application_name: dbt
[0m23:31:43.048071 [info ] [MainThread]:   retries: 1
[0m23:31:43.051175 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:31:44.590146 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:31:57.108036 [debug] [MainThread]: Using postgres connection "debug"
[0m23:31:57.110245 [debug] [MainThread]: On debug: select 1 as id
[0m23:31:57.112148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:57.481194 [debug] [MainThread]: SQL status: SELECT 1 in 0.369 seconds
[0m23:31:57.486170 [debug] [MainThread]: On debug: Close
[0m23:31:57.489121 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:31:57.493578 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:31:57.503612 [debug] [MainThread]: Command `dbt debug` succeeded at 23:31:57.502584 after 16.06 seconds
[0m23:31:57.507031 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:31:57.511081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E24222C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E28FC3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E2289F20>]}
[0m23:31:57.514150 [debug] [MainThread]: Flushing usage events
[0m23:31:58.793737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:44:09.616627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CCC04AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CDC4FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CDC4F9D0>]}


============================== 23:44:09.650531 | bb4e5afc-06ea-47d4-83ee-6ac3b216900d ==============================
[0m23:44:09.650531 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:44:09.653697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:44:11.022551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb4e5afc-06ea-47d4-83ee-6ac3b216900d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CD016B10>]}
[0m23:44:11.369732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb4e5afc-06ea-47d4-83ee-6ac3b216900d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CECD2580>]}
[0m23:44:11.378284 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:44:13.455536 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:44:13.459959 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:44:13.462502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb4e5afc-06ea-47d4-83ee-6ac3b216900d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CED6FC50>]}
[0m23:44:20.952597 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_health_insights_pipeline.stage_tg_messages' (models\stage_tg_messages.sql) depends on a source named 'Raw.raw_telegram_message_data' which was not found
[0m23:44:20.956369 [debug] [MainThread]: Command `dbt run` failed at 23:44:20.956028 after 11.76 seconds
[0m23:44:20.957358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF180D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF320230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CEE13BD0>]}
[0m23:44:20.958338 [debug] [MainThread]: Flushing usage events
[0m23:44:22.418485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:47:32.146612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A10B4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A31CBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A31CB9D0>]}


============================== 23:47:32.168644 | 0c94e3ee-9842-405b-9531-558976f63f0e ==============================
[0m23:47:32.168644 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:47:32.170532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:47:32.835903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c94e3ee-9842-405b-9531-558976f63f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A14C6B10>]}
[0m23:47:33.104144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c94e3ee-9842-405b-9531-558976f63f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A207E580>]}
[0m23:47:33.108184 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:47:33.797970 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:47:33.799818 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:47:33.801417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c94e3ee-9842-405b-9531-558976f63f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A2153C50>]}
[0m23:47:36.330003 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_health_insights_pipeline.stage_tg_messages' (models\stage_tg_messages.sql) depends on a source named 'Raw.raw_telegram_message_data' which was not found
[0m23:47:36.333970 [debug] [MainThread]: Command `dbt run` failed at 23:47:36.333623 after 4.58 seconds
[0m23:47:36.334978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A361CD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A37C8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A32C3BD0>]}
[0m23:47:36.336073 [debug] [MainThread]: Flushing usage events
[0m23:47:37.591009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:39.759570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EFE564AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EFF6ABD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EFF6AB9D0>]}


============================== 23:49:39.795288 | 9dfa43be-162e-4701-885b-0682c95144ad ==============================
[0m23:49:39.795288 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:49:39.798577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:49:40.463506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dfa43be-162e-4701-885b-0682c95144ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EFE976B10>]}
[0m23:49:40.625203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dfa43be-162e-4701-885b-0682c95144ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EFF52E580>]}
[0m23:49:40.629187 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:49:41.878322 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:49:41.884421 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:49:41.886879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9dfa43be-162e-4701-885b-0682c95144ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EFF5FFC50>]}
[0m23:49:45.141858 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_health_insights_pipeline.stage_tg_messages' (models\stage_tg_messages.sql) depends on a source named '"Raw".raw_telegram_message_data' which was not found
[0m23:49:45.145354 [debug] [MainThread]: Command `dbt run` failed at 23:49:45.144948 after 5.93 seconds
[0m23:49:45.146417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EFFB1CD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EFFCC4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EFF7A3BD0>]}
[0m23:49:45.147509 [debug] [MainThread]: Flushing usage events
[0m23:49:46.614143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:52:08.716747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287C894AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287D8DBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287D8DB9D0>]}


============================== 23:52:08.753963 | 62b083cc-ec41-48b6-bd9d-893d84ed61a7 ==============================
[0m23:52:08.753963 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:52:08.756902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:52:09.520018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62b083cc-ec41-48b6-bd9d-893d84ed61a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287CCA6B10>]}
[0m23:52:09.714943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62b083cc-ec41-48b6-bd9d-893d84ed61a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287E95E580>]}
[0m23:52:09.719686 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:52:10.680695 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:52:10.683823 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:52:10.685227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '62b083cc-ec41-48b6-bd9d-893d84ed61a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287E9FBC50>]}
[0m23:52:13.266792 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_health_insights_pipeline.stage_tg_messages' (models\stage_tg_messages.sql) depends on a source named '"Raw".raw_telegram_message_data' which was not found
[0m23:52:13.271666 [debug] [MainThread]: Command `dbt run` failed at 23:52:13.271017 after 4.98 seconds
[0m23:52:13.273270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287EED7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287F0FC140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287D8F7E70>]}
[0m23:52:13.274210 [debug] [MainThread]: Flushing usage events
[0m23:52:14.384298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:53:42.844335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A678C4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A68913D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A689139D0>]}


============================== 23:53:42.878855 | ca19b85d-11ec-47c2-8816-279c83e180de ==============================
[0m23:53:42.878855 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:53:42.881552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:43.877177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca19b85d-11ec-47c2-8816-279c83e180de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A67CD6B10>]}
[0m23:53:44.089760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca19b85d-11ec-47c2-8816-279c83e180de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A69996580>]}
[0m23:53:44.093926 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:53:45.913957 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:53:45.918546 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:53:45.921142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca19b85d-11ec-47c2-8816-279c83e180de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A69A2FC50>]}
[0m23:53:50.485118 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_health_insights_pipeline.stage_tg_messages' (models\stage_tg_messages.sql) depends on a source named 'Raw.raw_telegram_message_data' which was not found
[0m23:53:50.494508 [debug] [MainThread]: Command `dbt run` failed at 23:53:50.493481 after 8.11 seconds
[0m23:53:50.497364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A69F0F980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6A130140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6892FE70>]}
[0m23:53:50.500695 [debug] [MainThread]: Flushing usage events
[0m23:53:51.759216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:55:54.362422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EC9D4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EDA1FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EDA1F9D0>]}


============================== 23:55:54.383799 | 24e59a4b-651e-4d26-b94b-2585e022a83d ==============================
[0m23:55:54.383799 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:55:54.385662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:55:55.005383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4ECDE6B10>]}
[0m23:55:55.162644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EEAA2580>]}
[0m23:55:55.165925 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:55:56.214850 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:55:56.217321 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:55:56.218986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EEB3FC50>]}
[0m23:55:58.671978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EEB465D0>]}
[0m23:55:58.799369 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m23:55:58.806502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m23:55:58.968658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EED85470>]}
[0m23:55:58.969868 [info ] [MainThread]: Found 5 models, 1 source, 433 macros
[0m23:55:58.971445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EF0697E0>]}
[0m23:55:58.976073 [info ] [MainThread]: 
[0m23:55:58.977427 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:55:58.978711 [info ] [MainThread]: 
[0m23:55:58.980390 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:55:58.991724 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med'
[0m23:55:59.347992 [debug] [ThreadPool]: Using postgres connection "list_Tg_med"
[0m23:55:59.349039 [debug] [ThreadPool]: On list_Tg_med: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med"} */

    select distinct nspname from pg_namespace
  
[0m23:55:59.350052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:59.626995 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.277 seconds
[0m23:55:59.631497 [debug] [ThreadPool]: On list_Tg_med: Close
[0m23:55:59.637917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med_Raw'
[0m23:55:59.657288 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m23:55:59.658708 [debug] [ThreadPool]: On list_Tg_med_Raw: BEGIN
[0m23:55:59.659811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:59.841304 [debug] [ThreadPool]: SQL status: BEGIN in 0.181 seconds
[0m23:55:59.843890 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m23:55:59.846708 [debug] [ThreadPool]: On list_Tg_med_Raw: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med_Raw"} */
select
      'Tg_med' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'Raw'
  
[0m23:55:59.891295 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.042 seconds
[0m23:55:59.897427 [debug] [ThreadPool]: On list_Tg_med_Raw: ROLLBACK
[0m23:55:59.900779 [debug] [ThreadPool]: On list_Tg_med_Raw: Close
[0m23:55:59.932127 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:59.934959 [debug] [MainThread]: On master: BEGIN
[0m23:55:59.937739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:00.060947 [debug] [MainThread]: SQL status: BEGIN in 0.123 seconds
[0m23:56:00.061851 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:00.062766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:00.084081 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m23:56:00.086754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EF1BDE50>]}
[0m23:56:00.087779 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:00.088873 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:00.089621 [debug] [MainThread]: On master: BEGIN
[0m23:56:00.090860 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:56:00.091602 [debug] [MainThread]: On master: COMMIT
[0m23:56:00.092250 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:00.092887 [debug] [MainThread]: On master: COMMIT
[0m23:56:00.093766 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:00.094504 [debug] [MainThread]: On master: Close
[0m23:56:00.175625 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_dates
[0m23:56:00.178754 [info ] [Thread-1 (]: 1 of 4 START sql table model Raw.dim_dates ..................................... [RUN]
[0m23:56:00.183556 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_health_insights_pipeline.dim_dates'
[0m23:56:00.186714 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_dates
[0m23:56:00.230008 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_dates"
[0m23:56:00.249413 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_dates
[0m23:56:00.394087 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_dates"
[0m23:56:00.401036 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:56:00.402605 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: BEGIN
[0m23:56:00.403629 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:56:00.518722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.115 seconds
[0m23:56:00.519774 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:56:00.520718 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */

  
    

  create  table "Tg_med"."Raw"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH dates AS (
    SELECT
        date::DATE AS date_id,
        EXTRACT(DAY FROM date) AS day,
        EXTRACT(MONTH FROM date) AS month,
        EXTRACT(YEAR FROM date) AS year,
        TO_CHAR(date, 'Day') AS weekday,
        TO_CHAR(date, 'Month') AS month_name
    FROM generate_series(
        '2024-01-01'::DATE,
        CURRENT_DATE,
        INTERVAL '1 day'
    ) AS date
)

SELECT * FROM dates
  );
  
[0m23:56:00.550943 [debug] [Thread-1 (]: SQL status: SELECT 561 in 0.029 seconds
[0m23:56:00.576875 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:56:00.578148 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m23:56:00.580307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:00.629975 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m23:56:00.632247 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:56:00.633976 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m23:56:00.641250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:56:00.669830 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."dim_dates__dbt_backup"
[0m23:56:00.692898 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:56:00.694903 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
drop table if exists "Tg_med"."Raw"."dim_dates__dbt_backup" cascade
[0m23:56:00.700240 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:56:00.710447 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: Close
[0m23:56:00.726955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EF333AC0>]}
[0m23:56:00.730429 [info ] [Thread-1 (]: 1 of 4 OK created sql table model Raw.dim_dates ................................ [[32mSELECT 561[0m in 0.53s]
[0m23:56:00.733931 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_dates
[0m23:56:00.736058 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m23:56:00.738717 [info ] [Thread-1 (]: 2 of 4 START sql view model Raw.stage_tg_messages .............................. [RUN]
[0m23:56:00.741446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_dates, now model.telegram_health_insights_pipeline.stage_tg_messages)
[0m23:56:00.744817 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.stage_tg_messages
[0m23:56:00.757234 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:56:00.760488 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.stage_tg_messages
[0m23:56:00.840042 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:56:00.843709 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:56:00.845568 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: BEGIN
[0m23:56:00.847499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:00.997403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m23:56:00.998439 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:56:00.999467 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */

  create view "Tg_med"."Raw"."stage_tg_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "Tg_med"."Raw"."raw_telegram_message_data"
),

cleaned as (
    select
        cast(message_id AS BIGINT) AS message_id,
        cast(date as timestamp) as message_timestamp,
        text,
        cast(views as integer) as views,
        cast(forwards as integer) as forwards,
        media
    from source
)

select * from cleaned
  );
[0m23:56:01.029085 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m23:56:01.041307 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:56:01.042554 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages__dbt_tmp" rename to "stage_tg_messages"
[0m23:56:01.046164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:56:01.050049 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m23:56:01.051336 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:56:01.052437 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m23:56:01.056656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:56:01.062289 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."stage_tg_messages__dbt_backup"
[0m23:56:01.069313 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:56:01.070215 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
drop view if exists "Tg_med"."Raw"."stage_tg_messages__dbt_backup" cascade
[0m23:56:01.071872 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:56:01.074993 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: Close
[0m23:56:01.076469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EF1C3750>]}
[0m23:56:01.078714 [info ] [Thread-1 (]: 2 of 4 OK created sql view model Raw.stage_tg_messages ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m23:56:01.081678 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m23:56:01.083917 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_channels
[0m23:56:01.085255 [info ] [Thread-1 (]: 3 of 4 START sql table model Raw.dim_channels .................................. [RUN]
[0m23:56:01.086993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.stage_tg_messages, now model.telegram_health_insights_pipeline.dim_channels)
[0m23:56:01.088568 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_channels
[0m23:56:01.095841 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_channels"
[0m23:56:01.100290 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_channels
[0m23:56:01.108132 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_channels"
[0m23:56:01.111035 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m23:56:01.112102 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: BEGIN
[0m23:56:01.112880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:01.222228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.109 seconds
[0m23:56:01.223462 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m23:56:01.224740 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_channels"} */

  
    

  create  table "Tg_med"."Raw"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    channel_name AS channel_id, -- used as FK
    channel_name AS channel_display_name
FROM "Tg_med"."Raw"."stage_tg_messages"
WHERE channel_name IS NOT NULL
  );
  
[0m23:56:01.229134 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 15:     channel_name AS channel_id, -- used as FK
             ^

[0m23:56:01.230308 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: ROLLBACK
[0m23:56:01.231982 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: Close
[0m23:56:01.619429 [debug] [Thread-1 (]: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id, -- used as FK
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m23:56:01.620962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EF60D0D0>]}
[0m23:56:01.622803 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model Raw.dim_channels ......................... [[31mERROR[0m in 0.53s]
[0m23:56:01.625357 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_channels
[0m23:56:01.626568 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_messages
[0m23:56:01.627901 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.dim_channels' to be skipped because of status 'error'.  Reason: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id, -- used as FK
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql.
[0m23:56:01.629487 [info ] [Thread-1 (]: 4 of 4 START sql table model Raw.fct_messages .................................. [RUN]
[0m23:56:01.633293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_channels, now model.telegram_health_insights_pipeline.fct_messages)
[0m23:56:01.634341 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_messages
[0m23:56:01.648842 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_messages"
[0m23:56:01.653680 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_messages
[0m23:56:01.666661 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_messages"
[0m23:56:01.676919 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m23:56:01.678798 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: BEGIN
[0m23:56:01.680496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:01.804119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.124 seconds
[0m23:56:01.805560 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m23:56:01.806660 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */

  
    

  create  table "Tg_med"."Raw"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    channel_name AS channel_id,                     -- FK to dim_channels
    DATE(date) AS date_id,                          -- FK to dim_dates
    message_id,
    LENGTH(COALESCE(text, '')) AS message_length,
    text,
    sender_id,
    views,
    forwards,
    CASE
        WHEN media IS NOT NULL THEN TRUE
        ELSE FALSE
    END AS has_media
FROM "Tg_med"."Raw"."stage_tg_messages"
  );
  
[0m23:56:01.809251 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 15:     channel_name AS channel_id,                     -- FK to...
             ^

[0m23:56:01.810405 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: ROLLBACK
[0m23:56:01.812090 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: Close
[0m23:56:01.826343 [debug] [Thread-1 (]: Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id,                     -- FK to...
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m23:56:01.827615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24e59a4b-651e-4d26-b94b-2585e022a83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EF715E10>]}
[0m23:56:01.829181 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model Raw.fct_messages ......................... [[31mERROR[0m in 0.19s]
[0m23:56:01.831330 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_messages
[0m23:56:01.833114 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id,                     -- FK to...
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql.
[0m23:56:01.836512 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:01.837568 [debug] [MainThread]: On master: BEGIN
[0m23:56:01.838383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:01.952412 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m23:56:01.953404 [debug] [MainThread]: On master: COMMIT
[0m23:56:01.954250 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:01.955154 [debug] [MainThread]: On master: COMMIT
[0m23:56:01.956403 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:01.957305 [debug] [MainThread]: On master: Close
[0m23:56:01.958630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:01.959675 [debug] [MainThread]: Connection 'list_Tg_med' was properly closed.
[0m23:56:01.960548 [debug] [MainThread]: Connection 'list_Tg_med_Raw' was properly closed.
[0m23:56:01.961328 [debug] [MainThread]: Connection 'model.telegram_health_insights_pipeline.fct_messages' was properly closed.
[0m23:56:01.962564 [info ] [MainThread]: 
[0m23:56:01.964389 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m23:56:01.968987 [debug] [MainThread]: Command end result
[0m23:56:02.055779 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m23:56:02.064561 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m23:56:02.089260 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\run_results.json
[0m23:56:02.090953 [info ] [MainThread]: 
[0m23:56:02.093210 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:56:02.095362 [info ] [MainThread]: 
[0m23:56:02.097937 [error] [MainThread]: [31mFailure in model dim_channels (models\dim_channels.sql)[0m
[0m23:56:02.100965 [error] [MainThread]:   Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id, -- used as FK
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m23:56:02.103167 [info ] [MainThread]: 
[0m23:56:02.106535 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\dim_channels.sql
[0m23:56:02.108864 [info ] [MainThread]: 
[0m23:56:02.112566 [error] [MainThread]: [31mFailure in model fct_messages (models\fct_messages.sql)[0m
[0m23:56:02.116855 [error] [MainThread]:   Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id,                     -- FK to...
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m23:56:02.120331 [info ] [MainThread]: 
[0m23:56:02.124093 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\fct_messages.sql
[0m23:56:02.127699 [info ] [MainThread]: 
[0m23:56:02.133484 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m23:56:02.142049 [debug] [MainThread]: Command `dbt run` failed at 23:56:02.140866 after 8.04 seconds
[0m23:56:02.144875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EC665850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EC6EFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EEDF8950>]}
[0m23:56:02.150384 [debug] [MainThread]: Flushing usage events
[0m23:56:03.448098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:59:07.904235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2BD34AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2CD7FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2CD7F9D0>]}


============================== 23:59:07.931850 | b1d3d879-0763-4c7c-9c74-af11adb854b2 ==============================
[0m23:59:07.931850 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:59:07.934174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:08.439616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1d3d879-0763-4c7c-9c74-af11adb854b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2C146B10>]}
[0m23:59:09.889285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1d3d879-0763-4c7c-9c74-af11adb854b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2DE02580>]}
[0m23:59:09.897553 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:59:10.728035 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:59:11.556132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:59:11.557354 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\sources.yml
[0m23:59:11.835815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1d3d879-0763-4c7c-9c74-af11adb854b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2E295A50>]}
[0m23:59:12.023712 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m23:59:12.031476 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m23:59:12.172948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1d3d879-0763-4c7c-9c74-af11adb854b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2B8EBF20>]}
[0m23:59:12.175260 [info ] [MainThread]: Found 5 models, 1 source, 433 macros
[0m23:59:12.177339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1d3d879-0763-4c7c-9c74-af11adb854b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2E415FD0>]}
[0m23:59:12.183518 [info ] [MainThread]: 
[0m23:59:12.185340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:59:12.187515 [info ] [MainThread]: 
[0m23:59:12.190263 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:12.207724 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med'
[0m23:59:12.505127 [debug] [ThreadPool]: Using postgres connection "list_Tg_med"
[0m23:59:12.505955 [debug] [ThreadPool]: On list_Tg_med: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med"} */

    select distinct nspname from pg_namespace
  
[0m23:59:12.506716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:12.799740 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.293 seconds
[0m23:59:12.807607 [debug] [ThreadPool]: On list_Tg_med: Close
[0m23:59:12.816598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med_Raw'
[0m23:59:12.847403 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m23:59:12.849319 [debug] [ThreadPool]: On list_Tg_med_Raw: BEGIN
[0m23:59:12.850945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:13.073688 [debug] [ThreadPool]: SQL status: BEGIN in 0.223 seconds
[0m23:59:13.075436 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m23:59:13.077408 [debug] [ThreadPool]: On list_Tg_med_Raw: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med_Raw"} */
select
      'Tg_med' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'Raw'
  
[0m23:59:13.099573 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.020 seconds
[0m23:59:13.104442 [debug] [ThreadPool]: On list_Tg_med_Raw: ROLLBACK
[0m23:59:13.106176 [debug] [ThreadPool]: On list_Tg_med_Raw: Close
[0m23:59:13.123532 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:13.124997 [debug] [MainThread]: On master: BEGIN
[0m23:59:13.126446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:13.264619 [debug] [MainThread]: SQL status: BEGIN in 0.138 seconds
[0m23:59:13.266334 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:13.268974 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:13.309056 [debug] [MainThread]: SQL status: SELECT 1 in 0.036 seconds
[0m23:59:13.313883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1d3d879-0763-4c7c-9c74-af11adb854b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2E880600>]}
[0m23:59:13.315041 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:13.316363 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:13.317382 [debug] [MainThread]: On master: BEGIN
[0m23:59:13.319093 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:59:13.320068 [debug] [MainThread]: On master: COMMIT
[0m23:59:13.321141 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:13.322493 [debug] [MainThread]: On master: COMMIT
[0m23:59:13.324446 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:13.326241 [debug] [MainThread]: On master: Close
[0m23:59:13.340272 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_dates
[0m23:59:13.342032 [info ] [Thread-1 (]: 1 of 4 START sql table model Raw.dim_dates ..................................... [RUN]
[0m23:59:13.344699 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_health_insights_pipeline.dim_dates'
[0m23:59:13.346245 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_dates
[0m23:59:13.371565 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_dates"
[0m23:59:13.375181 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_dates
[0m23:59:13.508600 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_dates"
[0m23:59:13.511769 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:59:13.512916 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: BEGIN
[0m23:59:13.514029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:59:13.669912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m23:59:13.673200 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:59:13.675814 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */

  
    

  create  table "Tg_med"."Raw"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH dates AS (
    SELECT
        date::DATE AS date_id,
        EXTRACT(DAY FROM date) AS day,
        EXTRACT(MONTH FROM date) AS month,
        EXTRACT(YEAR FROM date) AS year,
        TO_CHAR(date, 'Day') AS weekday,
        TO_CHAR(date, 'Month') AS month_name
    FROM generate_series(
        '2024-01-01'::DATE,
        CURRENT_DATE,
        INTERVAL '1 day'
    ) AS date
)

SELECT * FROM dates
  );
  
[0m23:59:13.708928 [debug] [Thread-1 (]: SQL status: SELECT 561 in 0.031 seconds
[0m23:59:13.737209 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:59:13.739232 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates" rename to "dim_dates__dbt_backup"
[0m23:59:13.742041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:59:13.749528 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:59:13.750537 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m23:59:13.752558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:59:13.806249 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m23:59:13.807386 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:59:13.808366 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m23:59:14.743605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.934 seconds
[0m23:59:14.762907 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."dim_dates__dbt_backup"
[0m23:59:14.778462 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m23:59:14.780051 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
drop table if exists "Tg_med"."Raw"."dim_dates__dbt_backup" cascade
[0m23:59:14.903995 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.122 seconds
[0m23:59:14.910530 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: Close
[0m23:59:14.917584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1d3d879-0763-4c7c-9c74-af11adb854b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2E523110>]}
[0m23:59:14.919689 [info ] [Thread-1 (]: 1 of 4 OK created sql table model Raw.dim_dates ................................ [[32mSELECT 561[0m in 1.57s]
[0m23:59:14.922158 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_dates
[0m23:59:14.923431 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m23:59:14.924946 [info ] [Thread-1 (]: 2 of 4 START sql view model Raw.stage_tg_messages .............................. [RUN]
[0m23:59:14.926865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_dates, now model.telegram_health_insights_pipeline.stage_tg_messages)
[0m23:59:14.928569 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.stage_tg_messages
[0m23:59:14.935654 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:59:14.939960 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.stage_tg_messages
[0m23:59:15.090071 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:59:15.092680 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:59:15.093852 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: BEGIN
[0m23:59:15.094800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:15.311233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.216 seconds
[0m23:59:15.312491 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:59:15.313631 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */

  create view "Tg_med"."Raw"."stage_tg_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "Tg_med"."Raw"."raw_telegram_message_data"
),

cleaned as (
    select
        cast(message_id AS BIGINT) AS message_id,
        cast(date as timestamp) as message_timestamp,
        text,
        cast(views as integer) as views,
        cast(forwards as integer) as forwards,
        media
    from source
)

select * from cleaned
  );
[0m23:59:15.328379 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m23:59:15.338615 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:59:15.339792 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages" rename to "stage_tg_messages__dbt_backup"
[0m23:59:15.342172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:59:15.350500 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:59:15.352084 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages__dbt_tmp" rename to "stage_tg_messages"
[0m23:59:15.354164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:59:15.358156 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m23:59:15.359060 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:59:15.359849 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m23:59:16.139354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.779 seconds
[0m23:59:16.146443 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."stage_tg_messages__dbt_backup"
[0m23:59:16.156710 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m23:59:16.158034 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
drop view if exists "Tg_med"."Raw"."stage_tg_messages__dbt_backup" cascade
[0m23:59:16.162736 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:59:16.166844 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: Close
[0m23:59:16.168865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1d3d879-0763-4c7c-9c74-af11adb854b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2E571440>]}
[0m23:59:16.170856 [info ] [Thread-1 (]: 2 of 4 OK created sql view model Raw.stage_tg_messages ......................... [[32mCREATE VIEW[0m in 1.24s]
[0m23:59:16.173880 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m23:59:16.175789 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_channels
[0m23:59:16.177455 [info ] [Thread-1 (]: 3 of 4 START sql table model Raw.dim_channels .................................. [RUN]
[0m23:59:16.179497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.stage_tg_messages, now model.telegram_health_insights_pipeline.dim_channels)
[0m23:59:16.180992 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_channels
[0m23:59:16.190946 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_channels"
[0m23:59:16.194210 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_channels
[0m23:59:16.207087 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_channels"
[0m23:59:16.210017 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m23:59:16.211525 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: BEGIN
[0m23:59:16.213171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:16.334312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.121 seconds
[0m23:59:16.335548 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m23:59:16.336744 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_channels"} */

  
    

  create  table "Tg_med"."Raw"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    channel_name AS channel_id, -- used as FK
    channel_name AS channel_display_name
FROM "Tg_med"."Raw"."stage_tg_messages"
WHERE channel_name IS NOT NULL
  );
  
[0m23:59:16.339752 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 15:     channel_name AS channel_id, -- used as FK
             ^

[0m23:59:16.341107 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: ROLLBACK
[0m23:59:16.342987 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: Close
[0m23:59:16.366461 [debug] [Thread-1 (]: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id, -- used as FK
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m23:59:16.368583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1d3d879-0763-4c7c-9c74-af11adb854b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2E08FA70>]}
[0m23:59:17.301105 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model Raw.dim_channels ......................... [[31mERROR[0m in 0.19s]
[0m23:59:17.306422 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_channels
[0m23:59:17.308893 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_messages
[0m23:59:17.313078 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.dim_channels' to be skipped because of status 'error'.  Reason: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id, -- used as FK
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql.
[0m23:59:17.320210 [info ] [Thread-1 (]: 4 of 4 START sql table model Raw.fct_messages .................................. [RUN]
[0m23:59:17.331200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_channels, now model.telegram_health_insights_pipeline.fct_messages)
[0m23:59:17.335155 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_messages
[0m23:59:17.357703 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_messages"
[0m23:59:17.373151 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_messages
[0m23:59:17.397209 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_messages"
[0m23:59:17.403955 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m23:59:17.406413 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: BEGIN
[0m23:59:17.409073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:17.634492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m23:59:17.636968 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m23:59:17.639299 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */

  
    

  create  table "Tg_med"."Raw"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    channel_name AS channel_id,                     -- FK to dim_channels
    DATE(date) AS date_id,                          -- FK to dim_dates
    message_id,
    LENGTH(COALESCE(text, '')) AS message_length,
    text,
    sender_id,
    views,
    forwards,
    CASE
        WHEN media IS NOT NULL THEN TRUE
        ELSE FALSE
    END AS has_media
FROM "Tg_med"."Raw"."stage_tg_messages"
  );
  
[0m23:59:17.645037 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 15:     channel_name AS channel_id,                     -- FK to...
             ^

[0m23:59:17.647449 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: ROLLBACK
[0m23:59:17.651236 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: Close
[0m23:59:17.687277 [debug] [Thread-1 (]: Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id,                     -- FK to...
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m23:59:17.689913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1d3d879-0763-4c7c-9c74-af11adb854b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2E820150>]}
[0m23:59:17.693951 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model Raw.fct_messages ......................... [[31mERROR[0m in 0.36s]
[0m23:59:17.698240 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_messages
[0m23:59:17.702435 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id,                     -- FK to...
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql.
[0m23:59:17.709568 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:17.712057 [debug] [MainThread]: On master: BEGIN
[0m23:59:17.714167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:59:17.953916 [debug] [MainThread]: SQL status: BEGIN in 0.240 seconds
[0m23:59:18.659833 [debug] [MainThread]: On master: COMMIT
[0m23:59:18.660880 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:18.661807 [debug] [MainThread]: On master: COMMIT
[0m23:59:18.663136 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:18.664084 [debug] [MainThread]: On master: Close
[0m23:59:18.665954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:18.667390 [debug] [MainThread]: Connection 'list_Tg_med' was properly closed.
[0m23:59:18.668868 [debug] [MainThread]: Connection 'list_Tg_med_Raw' was properly closed.
[0m23:59:18.670087 [debug] [MainThread]: Connection 'model.telegram_health_insights_pipeline.fct_messages' was properly closed.
[0m23:59:18.672540 [info ] [MainThread]: 
[0m23:59:18.675681 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m23:59:18.684309 [debug] [MainThread]: Command end result
[0m23:59:18.855847 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m23:59:18.864475 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m23:59:18.885786 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\run_results.json
[0m23:59:18.887049 [info ] [MainThread]: 
[0m23:59:18.888659 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:59:18.890343 [info ] [MainThread]: 
[0m23:59:18.892242 [error] [MainThread]: [31mFailure in model dim_channels (models\dim_channels.sql)[0m
[0m23:59:18.894373 [error] [MainThread]:   Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id, -- used as FK
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m23:59:18.896559 [info ] [MainThread]: 
[0m23:59:18.899046 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\dim_channels.sql
[0m23:59:18.900821 [info ] [MainThread]: 
[0m23:59:18.903334 [error] [MainThread]: [31mFailure in model fct_messages (models\fct_messages.sql)[0m
[0m23:59:18.905553 [error] [MainThread]:   Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id,                     -- FK to...
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m23:59:18.908074 [info ] [MainThread]: 
[0m23:59:18.910353 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\fct_messages.sql
[0m23:59:18.911989 [info ] [MainThread]: 
[0m23:59:18.913641 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m23:59:18.917558 [debug] [MainThread]: Command `dbt run` failed at 23:59:18.917223 after 11.36 seconds
[0m23:59:18.918461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2DE83B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E266D9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2C0A2510>]}
[0m23:59:18.919779 [debug] [MainThread]: Flushing usage events
[0m23:59:20.052406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:02:42.838113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015057284AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150582CFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150582CF9D0>]}


============================== 00:02:42.865201 | ea1ef0aa-895e-4af1-acc0-4691a8ea2852 ==============================
[0m00:02:42.865201 [info ] [MainThread]: Running with dbt=1.10.4
[0m00:02:42.867632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:02:43.394787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea1ef0aa-895e-4af1-acc0-4691a8ea2852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015057696B10>]}
[0m00:02:43.550250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea1ef0aa-895e-4af1-acc0-4691a8ea2852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015058382580>]}
[0m00:02:43.554187 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:02:44.214700 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m00:02:44.693625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:02:44.695005 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\dim_channels.sql
[0m00:02:45.195720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea1ef0aa-895e-4af1-acc0-4691a8ea2852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015059856C50>]}
[0m00:02:45.342563 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m00:02:45.346537 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m00:02:45.437987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea1ef0aa-895e-4af1-acc0-4691a8ea2852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015059461130>]}
[0m00:02:45.439764 [info ] [MainThread]: Found 5 models, 1 source, 433 macros
[0m00:02:45.441196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea1ef0aa-895e-4af1-acc0-4691a8ea2852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015059B73930>]}
[0m00:02:45.445167 [info ] [MainThread]: 
[0m00:02:45.446373 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:02:45.447905 [info ] [MainThread]: 
[0m00:02:45.449662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:02:45.462975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med'
[0m00:02:45.697506 [debug] [ThreadPool]: Using postgres connection "list_Tg_med"
[0m00:02:45.698557 [debug] [ThreadPool]: On list_Tg_med: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med"} */

    select distinct nspname from pg_namespace
  
[0m00:02:45.699110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:45.800665 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.101 seconds
[0m00:02:45.803401 [debug] [ThreadPool]: On list_Tg_med: Close
[0m00:02:45.807617 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med_Raw'
[0m00:02:45.818856 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m00:02:45.819638 [debug] [ThreadPool]: On list_Tg_med_Raw: BEGIN
[0m00:02:45.820289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:45.912403 [debug] [ThreadPool]: SQL status: BEGIN in 0.092 seconds
[0m00:02:45.913393 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m00:02:45.914308 [debug] [ThreadPool]: On list_Tg_med_Raw: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med_Raw"} */
select
      'Tg_med' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'Raw'
  
[0m00:02:45.931973 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.017 seconds
[0m00:02:45.935272 [debug] [ThreadPool]: On list_Tg_med_Raw: ROLLBACK
[0m00:02:45.936590 [debug] [ThreadPool]: On list_Tg_med_Raw: Close
[0m00:02:45.948920 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:45.949920 [debug] [MainThread]: On master: BEGIN
[0m00:02:45.950705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:02:46.190179 [debug] [MainThread]: SQL status: BEGIN in 0.239 seconds
[0m00:02:46.192122 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:46.194479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:02:46.223593 [debug] [MainThread]: SQL status: SELECT 1 in 0.027 seconds
[0m00:02:46.227903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea1ef0aa-895e-4af1-acc0-4691a8ea2852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015059DE3450>]}
[0m00:02:46.229354 [debug] [MainThread]: On master: ROLLBACK
[0m00:02:46.230997 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:46.232069 [debug] [MainThread]: On master: BEGIN
[0m00:02:46.234009 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:02:46.234989 [debug] [MainThread]: On master: COMMIT
[0m00:02:46.235807 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:46.236578 [debug] [MainThread]: On master: COMMIT
[0m00:02:46.237910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:02:46.239550 [debug] [MainThread]: On master: Close
[0m00:02:46.255302 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_dates
[0m00:02:46.256853 [info ] [Thread-1 (]: 1 of 4 START sql table model Raw.dim_dates ..................................... [RUN]
[0m00:02:46.259473 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_health_insights_pipeline.dim_dates'
[0m00:02:46.261245 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_dates
[0m00:02:46.415418 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_dates"
[0m00:02:46.417502 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_dates
[0m00:02:46.500774 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_dates"
[0m00:02:46.503102 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m00:02:46.504246 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: BEGIN
[0m00:02:46.505131 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:02:46.600862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m00:02:46.601987 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m00:02:46.603124 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */

  
    

  create  table "Tg_med"."Raw"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH dates AS (
    SELECT
        date::DATE AS date_id,
        EXTRACT(DAY FROM date) AS day,
        EXTRACT(MONTH FROM date) AS month,
        EXTRACT(YEAR FROM date) AS year,
        TO_CHAR(date, 'Day') AS weekday,
        TO_CHAR(date, 'Month') AS month_name
    FROM generate_series(
        '2024-01-01'::DATE,
        CURRENT_DATE,
        INTERVAL '1 day'
    ) AS date
)

SELECT * FROM dates
  );
  
[0m00:02:46.628578 [debug] [Thread-1 (]: SQL status: SELECT 562 in 0.024 seconds
[0m00:02:46.653599 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m00:02:46.654758 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates" rename to "dim_dates__dbt_backup"
[0m00:02:46.656781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:02:46.665284 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m00:02:46.666399 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m00:02:46.668904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:02:46.715308 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m00:02:46.716476 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m00:02:46.717557 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m00:02:46.722680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:02:46.744087 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."dim_dates__dbt_backup"
[0m00:02:46.763907 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m00:02:46.765028 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
drop table if exists "Tg_med"."Raw"."dim_dates__dbt_backup" cascade
[0m00:02:46.775878 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m00:02:46.782845 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: Close
[0m00:02:46.790850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea1ef0aa-895e-4af1-acc0-4691a8ea2852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015059B9B950>]}
[0m00:02:46.793099 [info ] [Thread-1 (]: 1 of 4 OK created sql table model Raw.dim_dates ................................ [[32mSELECT 562[0m in 0.53s]
[0m00:02:46.795616 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_dates
[0m00:02:46.797312 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m00:02:46.799302 [info ] [Thread-1 (]: 2 of 4 START sql view model Raw.stage_tg_messages .............................. [RUN]
[0m00:02:46.801358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_dates, now model.telegram_health_insights_pipeline.stage_tg_messages)
[0m00:02:46.803178 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.stage_tg_messages
[0m00:02:46.813427 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m00:02:46.817081 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.stage_tg_messages
[0m00:02:46.948784 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m00:02:46.959269 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m00:02:46.961743 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: BEGIN
[0m00:02:46.964677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:47.110496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.146 seconds
[0m00:02:47.112643 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m00:02:47.114515 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */

  create view "Tg_med"."Raw"."stage_tg_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "Tg_med"."Raw"."raw_telegram_message_data"
),

cleaned as (
    select
        cast(message_id AS BIGINT) AS message_id,
        cast(date as timestamp) as message_timestamp,
        text,
        cast(views as integer) as views,
        cast(forwards as integer) as forwards,
        media
    from source
)

select * from cleaned
  );
[0m00:02:47.138153 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m00:02:47.154155 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m00:02:47.156936 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages" rename to "stage_tg_messages__dbt_backup"
[0m00:02:47.161144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:02:47.173486 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m00:02:47.176121 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages__dbt_tmp" rename to "stage_tg_messages"
[0m00:02:47.180248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:02:47.189704 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m00:02:47.193841 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m00:02:47.197110 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m00:02:47.208938 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m00:02:47.230491 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."stage_tg_messages__dbt_backup"
[0m00:02:47.263911 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m00:02:47.265598 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
drop view if exists "Tg_med"."Raw"."stage_tg_messages__dbt_backup" cascade
[0m00:02:47.271938 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m00:02:47.276584 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: Close
[0m00:02:47.278982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea1ef0aa-895e-4af1-acc0-4691a8ea2852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015059C19FF0>]}
[0m00:02:47.281198 [info ] [Thread-1 (]: 2 of 4 OK created sql view model Raw.stage_tg_messages ......................... [[32mCREATE VIEW[0m in 0.48s]
[0m00:02:47.283854 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m00:02:47.287766 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_channels
[0m00:02:47.291413 [info ] [Thread-1 (]: 3 of 4 START sql table model Raw.dim_channels .................................. [RUN]
[0m00:02:47.294858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.stage_tg_messages, now model.telegram_health_insights_pipeline.dim_channels)
[0m00:02:47.296791 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_channels
[0m00:02:47.310877 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_channels"
[0m00:02:47.314018 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_channels
[0m00:02:47.327791 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_channels"
[0m00:02:47.330576 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m00:02:47.332130 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: BEGIN
[0m00:02:47.333814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:47.450367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.116 seconds
[0m00:02:47.451757 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m00:02:47.453074 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_channels"} */

  
    

  create  table "Tg_med"."Raw"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    channel_name AS channel_display_name
FROM "Tg_med"."Raw"."stage_tg_messages"
WHERE channel_name IS NOT NULL
  );
  
[0m00:02:47.455590 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 15:     channel_name AS channel_display_name
             ^

[0m00:02:47.457027 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: ROLLBACK
[0m00:02:47.458778 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: Close
[0m00:02:47.476357 [debug] [Thread-1 (]: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m00:02:47.477532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea1ef0aa-895e-4af1-acc0-4691a8ea2852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150582C0730>]}
[0m00:02:47.478891 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model Raw.dim_channels ......................... [[31mERROR[0m in 0.18s]
[0m00:02:47.480705 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_channels
[0m00:02:47.481619 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_messages
[0m00:02:47.482821 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.dim_channels' to be skipped because of status 'error'.  Reason: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql.
[0m00:02:47.483846 [info ] [Thread-1 (]: 4 of 4 START sql table model Raw.fct_messages .................................. [RUN]
[0m00:02:47.487213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_channels, now model.telegram_health_insights_pipeline.fct_messages)
[0m00:02:47.488144 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_messages
[0m00:02:47.496357 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_messages"
[0m00:02:47.498658 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_messages
[0m00:02:47.506521 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_messages"
[0m00:02:47.510078 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m00:02:47.511009 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: BEGIN
[0m00:02:47.511751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:47.680873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.169 seconds
[0m00:02:47.682785 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m00:02:47.684901 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */

  
    

  create  table "Tg_med"."Raw"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    channel_name AS channel_id,                     -- FK to dim_channels
    DATE(date) AS date_id,                          -- FK to dim_dates
    message_id,
    LENGTH(COALESCE(text, '')) AS message_length,
    text,
    sender_id,
    views,
    forwards,
    CASE
        WHEN media IS NOT NULL THEN TRUE
        ELSE FALSE
    END AS has_media
FROM "Tg_med"."Raw"."stage_tg_messages"
  );
  
[0m00:02:47.689005 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 15:     channel_name AS channel_id,                     -- FK to...
             ^

[0m00:02:47.690709 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: ROLLBACK
[0m00:02:47.693560 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: Close
[0m00:02:47.716165 [debug] [Thread-1 (]: Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id,                     -- FK to...
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m00:02:47.718056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea1ef0aa-895e-4af1-acc0-4691a8ea2852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001505968C650>]}
[0m00:02:47.721061 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model Raw.fct_messages ......................... [[31mERROR[0m in 0.23s]
[0m00:02:47.724472 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_messages
[0m00:02:47.726965 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id,                     -- FK to...
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql.
[0m00:02:47.731458 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:47.732598 [debug] [MainThread]: On master: BEGIN
[0m00:02:47.733752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:02:47.865827 [debug] [MainThread]: SQL status: BEGIN in 0.132 seconds
[0m00:02:47.866644 [debug] [MainThread]: On master: COMMIT
[0m00:02:47.867338 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:47.868319 [debug] [MainThread]: On master: COMMIT
[0m00:02:47.869313 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:02:47.870067 [debug] [MainThread]: On master: Close
[0m00:02:47.871109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:02:47.871873 [debug] [MainThread]: Connection 'list_Tg_med' was properly closed.
[0m00:02:47.872490 [debug] [MainThread]: Connection 'list_Tg_med_Raw' was properly closed.
[0m00:02:47.873147 [debug] [MainThread]: Connection 'model.telegram_health_insights_pipeline.fct_messages' was properly closed.
[0m00:02:47.874051 [info ] [MainThread]: 
[0m00:02:47.875359 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m00:02:47.879487 [debug] [MainThread]: Command end result
[0m00:02:47.932890 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m00:02:47.942496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m00:02:47.963304 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\run_results.json
[0m00:02:47.964492 [info ] [MainThread]: 
[0m00:02:47.966252 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:02:47.968522 [info ] [MainThread]: 
[0m00:02:47.971072 [error] [MainThread]: [31mFailure in model dim_channels (models\dim_channels.sql)[0m
[0m00:02:47.972520 [error] [MainThread]:   Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m00:02:47.974880 [info ] [MainThread]: 
[0m00:02:47.977107 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\dim_channels.sql
[0m00:02:47.979482 [info ] [MainThread]: 
[0m00:02:47.982412 [error] [MainThread]: [31mFailure in model fct_messages (models\fct_messages.sql)[0m
[0m00:02:47.984392 [error] [MainThread]:   Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_id,                     -- FK to...
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m00:02:47.986051 [info ] [MainThread]: 
[0m00:02:47.988851 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\fct_messages.sql
[0m00:02:47.990721 [info ] [MainThread]: 
[0m00:02:47.995190 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m00:02:48.001908 [debug] [MainThread]: Command `dbt run` failed at 00:02:48.001465 after 5.49 seconds
[0m00:02:48.003932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015058403B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015051C29550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015056B0DD90>]}
[0m00:02:48.006264 [debug] [MainThread]: Flushing usage events
[0m00:02:49.075150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:20.822187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EB114AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EC15FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EC15F9D0>]}


============================== 00:06:20.851420 | 9da6aadb-e439-4e44-b7f3-5611062b0c85 ==============================
[0m00:06:20.851420 [info ] [MainThread]: Running with dbt=1.10.4
[0m00:06:20.853215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m00:06:21.861569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9da6aadb-e439-4e44-b7f3-5611062b0c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EB526B10>]}
[0m00:06:22.164003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9da6aadb-e439-4e44-b7f3-5611062b0c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7ED1E2580>]}
[0m00:06:22.172458 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:06:23.732596 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m00:06:24.489096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:06:24.490671 [debug] [MainThread]: Partial parsing: added file: telegram_health_insights_pipeline://tests\no_message.sql
[0m00:06:25.138641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9da6aadb-e439-4e44-b7f3-5611062b0c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7ED6FEC50>]}
[0m00:06:25.256549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9da6aadb-e439-4e44-b7f3-5611062b0c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7ED8D7110>]}
[0m00:06:25.257775 [info ] [MainThread]: Found 5 models, 1 test, 1 source, 433 macros
[0m00:06:25.259114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9da6aadb-e439-4e44-b7f3-5611062b0c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7ED963930>]}
[0m00:06:25.263866 [info ] [MainThread]: 
[0m00:06:25.265249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:25.267314 [info ] [MainThread]: 
[0m00:06:25.269006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:06:25.279727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med_Raw'
[0m00:06:25.679355 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m00:06:25.680131 [debug] [ThreadPool]: On list_Tg_med_Raw: BEGIN
[0m00:06:25.680772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:25.797257 [debug] [ThreadPool]: SQL status: BEGIN in 0.116 seconds
[0m00:06:25.798725 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m00:06:25.800104 [debug] [ThreadPool]: On list_Tg_med_Raw: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med_Raw"} */
select
      'Tg_med' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'Raw'
  
[0m00:06:25.828733 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.027 seconds
[0m00:06:25.836308 [debug] [ThreadPool]: On list_Tg_med_Raw: ROLLBACK
[0m00:06:25.840313 [debug] [ThreadPool]: On list_Tg_med_Raw: Close
[0m00:06:25.871675 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:25.873570 [debug] [MainThread]: On master: BEGIN
[0m00:06:25.875276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:06:26.157660 [debug] [MainThread]: SQL status: BEGIN in 0.282 seconds
[0m00:06:26.160224 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:26.163151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:06:26.208381 [debug] [MainThread]: SQL status: SELECT 1 in 0.041 seconds
[0m00:06:26.214140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9da6aadb-e439-4e44-b7f3-5611062b0c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EDC5CC80>]}
[0m00:06:26.218150 [debug] [MainThread]: On master: ROLLBACK
[0m00:06:26.220894 [debug] [MainThread]: On master: Close
[0m00:06:26.238939 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_dates
[0m00:06:26.240359 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_health_insights_pipeline.dim_dates'
[0m00:06:26.241517 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_dates
[0m00:06:26.265543 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_dates"
[0m00:06:26.271736 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_dates
[0m00:06:26.275152 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_dates
[0m00:06:26.276825 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_image_detections
[0m00:06:26.278565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_dates, now model.telegram_health_insights_pipeline.fct_image_detections)
[0m00:06:26.282035 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_image_detections
[0m00:06:26.289164 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m00:06:26.290453 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_image_detections
[0m00:06:26.292835 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_image_detections
[0m00:06:26.294416 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m00:06:26.296080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.fct_image_detections, now model.telegram_health_insights_pipeline.stage_tg_messages)
[0m00:06:26.297403 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.stage_tg_messages
[0m00:06:26.306656 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m00:06:26.309969 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.stage_tg_messages
[0m00:06:26.312632 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m00:06:26.314901 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_channels
[0m00:06:26.317865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.stage_tg_messages, now model.telegram_health_insights_pipeline.dim_channels)
[0m00:06:26.319875 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_channels
[0m00:06:26.326396 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_channels"
[0m00:06:26.329150 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_channels
[0m00:06:26.331713 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_channels
[0m00:06:26.334745 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_messages
[0m00:06:26.337032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_channels, now model.telegram_health_insights_pipeline.fct_messages)
[0m00:06:26.338122 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_messages
[0m00:06:26.346154 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_messages"
[0m00:06:26.351320 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_messages
[0m00:06:26.358416 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_messages
[0m00:06:26.360421 [debug] [Thread-1 (]: Began running node test.telegram_health_insights_pipeline.no_message
[0m00:06:26.361980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.fct_messages, now test.telegram_health_insights_pipeline.no_message)
[0m00:06:26.363532 [debug] [Thread-1 (]: Began compiling node test.telegram_health_insights_pipeline.no_message
[0m00:06:26.375666 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_health_insights_pipeline.no_message"
[0m00:06:26.381125 [debug] [Thread-1 (]: Began executing node test.telegram_health_insights_pipeline.no_message
[0m00:06:26.388602 [debug] [Thread-1 (]: Finished running node test.telegram_health_insights_pipeline.no_message
[0m00:06:26.393300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:26.394784 [debug] [MainThread]: Connection 'list_Tg_med_Raw' was properly closed.
[0m00:06:26.396175 [debug] [MainThread]: Connection 'test.telegram_health_insights_pipeline.no_message' was properly closed.
[0m00:06:26.404094 [debug] [MainThread]: Command end result
[0m00:06:26.923060 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m00:06:26.933141 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m00:06:26.961907 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\run_results.json
[0m00:06:28.178835 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m00:06:28.179884 [info ] [MainThread]: Building catalog
[0m00:06:28.210896 [debug] [ThreadPool]: Acquiring new postgres connection 'Tg_med.information_schema'
[0m00:06:28.253795 [debug] [ThreadPool]: Using postgres connection "Tg_med.information_schema"
[0m00:06:28.255347 [debug] [ThreadPool]: On Tg_med.information_schema: BEGIN
[0m00:06:28.256338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:28.486298 [debug] [ThreadPool]: SQL status: BEGIN in 0.230 seconds
[0m00:06:28.487112 [debug] [ThreadPool]: Using postgres connection "Tg_med.information_schema"
[0m00:06:28.488920 [debug] [ThreadPool]: On Tg_med.information_schema: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "Tg_med.information_schema"} */

    
    

    select
        'Tg_med' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('Raw') and
           upper(tbl.relname) = upper('raw_telegram_message_data')) or (upper(sch.nspname) = upper('Raw') and
           upper(tbl.relname) = upper('fct_image_detections')) or (upper(sch.nspname) = upper('Raw') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('Raw') and
           upper(tbl.relname) = upper('dim_dates')) or (upper(sch.nspname) = upper('Raw') and
           upper(tbl.relname) = upper('stage_tg_messages')) or (upper(sch.nspname) = upper('Raw') and
           upper(tbl.relname) = upper('fct_messages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m00:06:28.511188 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.020 seconds
[0m00:06:28.520062 [debug] [ThreadPool]: On Tg_med.information_schema: ROLLBACK
[0m00:06:28.521595 [debug] [ThreadPool]: On Tg_med.information_schema: Close
[0m00:06:28.567140 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\catalog.json
[0m00:06:28.737789 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m00:06:28.748145 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m00:06:28.750696 [info ] [MainThread]: Catalog written to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\catalog.json
[0m00:06:28.755868 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:06:28.755417 after 8.56 seconds
[0m00:06:28.757030 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:06:28.758400 [debug] [MainThread]: Connection 'Tg_med.information_schema' was properly closed.
[0m00:06:28.759682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7ED22D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7ED634EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7ED927750>]}
[0m00:06:28.761342 [debug] [MainThread]: Flushing usage events
[0m00:06:29.806428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:49.863759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022221794AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222227E3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222227E39D0>]}


============================== 00:06:49.900576 | 753f34bf-64f1-4a16-9d90-1369fab72ec2 ==============================
[0m00:06:49.900576 [info ] [MainThread]: Running with dbt=1.10.4
[0m00:06:49.904496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:06:51.036497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '753f34bf-64f1-4a16-9d90-1369fab72ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022221BA6B10>]}
[0m00:06:51.366241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '753f34bf-64f1-4a16-9d90-1369fab72ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022223862690>]}
[0m12:45:14.897002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299607EC590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995E4F8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299628E3C50>]}


============================== 12:45:14.907810 | b4569239-39a4-4cf2-9071-0460f952fbfb ==============================
[0m12:45:14.907810 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:45:14.908862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:15.568584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4569239-39a4-4cf2-9071-0460f952fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029960BB0510>]}
[0m12:45:15.645799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4569239-39a4-4cf2-9071-0460f952fbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029961842140>]}
[0m12:45:15.649546 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:45:16.287995 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:45:18.547363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:45:18.548083 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\fct_image_detections.sql
[0m12:45:18.548616 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\fct_messages.sql
[0m12:45:18.781256 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_health_insights_pipeline.fct_image_detections' (models\fct_image_detections.sql) depends on a source named 'Raw.raw_image_detections' which was not found
[0m12:45:18.783062 [debug] [MainThread]: Command `dbt run` failed at 12:45:18.782869 after 4.08 seconds
[0m12:45:18.783526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002996173E850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029962D85150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029962F6C230>]}
[0m12:45:18.783935 [debug] [MainThread]: Flushing usage events
[0m12:45:19.963099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:45.525875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B16F64590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B14CBC190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B19067C50>]}


============================== 12:45:45.536271 | e230640d-52e1-4613-9e5d-1119b070f7aa ==============================
[0m12:45:45.536271 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:45:45.537085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:45.803835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e230640d-52e1-4613-9e5d-1119b070f7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B17330510>]}
[0m12:45:45.914173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e230640d-52e1-4613-9e5d-1119b070f7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B17F86140>]}
[0m12:45:45.916391 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:45:46.308972 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:45:46.521943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:45:46.522580 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\fct_messages.sql
[0m12:45:46.523048 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\fct_image_detections.sql
[0m12:45:46.759207 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_health_insights_pipeline.fct_image_detections' (models\fct_image_detections.sql) depends on a source named 'Raw.raw_image_detection' which was not found
[0m12:45:46.760939 [debug] [MainThread]: Command `dbt run` failed at 12:45:46.760785 after 1.40 seconds
[0m12:45:46.761439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B17EBE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B194F1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B196DC230>]}
[0m12:45:46.762123 [debug] [MainThread]: Flushing usage events
[0m12:45:47.636961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:07.657914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226364B8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263421C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226385B7C50>]}


============================== 12:48:07.668535 | 5e3ecd40-a203-41e1-bbeb-2992610ae073 ==============================
[0m12:48:07.668535 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:48:07.669807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:48:07.965513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022636880510>]}
[0m12:48:08.045204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226374D6140>]}
[0m12:48:08.047127 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:48:08.460473 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:48:08.774069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m12:48:08.774966 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\sources.yml
[0m12:48:08.775393 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\fct_messages.sql
[0m12:48:08.775888 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\fct_image_detections.sql
[0m12:48:09.604958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022638A73150>]}
[0m12:48:09.713893 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m12:48:09.717690 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m12:48:09.840548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226385D2F30>]}
[0m12:48:09.841142 [info ] [MainThread]: Found 5 models, 1 test, 2 sources, 433 macros
[0m12:48:09.841802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022638729710>]}
[0m12:48:09.844000 [info ] [MainThread]: 
[0m12:48:09.844702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:09.845226 [info ] [MainThread]: 
[0m12:48:09.845925 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:48:09.850994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med'
[0m12:48:14.544058 [debug] [ThreadPool]: Using postgres connection "list_Tg_med"
[0m12:48:14.544543 [debug] [ThreadPool]: On list_Tg_med: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med"} */

    select distinct nspname from pg_namespace
  
[0m12:48:14.544886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:14.628536 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.084 seconds
[0m12:48:14.630564 [debug] [ThreadPool]: On list_Tg_med: Close
[0m12:48:14.632744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med_Raw'
[0m12:48:14.638620 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m12:48:14.639041 [debug] [ThreadPool]: On list_Tg_med_Raw: BEGIN
[0m12:48:14.639358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:14.794488 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m12:48:14.794913 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m12:48:14.795330 [debug] [ThreadPool]: On list_Tg_med_Raw: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med_Raw"} */
select
      'Tg_med' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'Raw'
  
[0m12:48:14.808031 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m12:48:14.809475 [debug] [ThreadPool]: On list_Tg_med_Raw: ROLLBACK
[0m12:48:14.810086 [debug] [ThreadPool]: On list_Tg_med_Raw: Close
[0m12:48:14.817498 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:14.817943 [debug] [MainThread]: On master: BEGIN
[0m12:48:14.818250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:14.866799 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m12:48:14.867294 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:14.867805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:48:14.883366 [debug] [MainThread]: SQL status: SELECT 1 in 0.015 seconds
[0m12:48:14.885006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022639005E60>]}
[0m12:48:14.885465 [debug] [MainThread]: On master: ROLLBACK
[0m12:48:14.886054 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:14.886393 [debug] [MainThread]: On master: BEGIN
[0m12:48:14.887340 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:48:14.887738 [debug] [MainThread]: On master: COMMIT
[0m12:48:14.888067 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:14.888447 [debug] [MainThread]: On master: COMMIT
[0m12:48:14.888964 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:48:14.889346 [debug] [MainThread]: On master: Close
[0m12:48:14.919029 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_dates
[0m12:48:14.919662 [info ] [Thread-1 (]: 1 of 5 START sql table model Raw.dim_dates ..................................... [RUN]
[0m12:48:14.920577 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_health_insights_pipeline.dim_dates'
[0m12:48:14.921028 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_dates
[0m12:48:14.928948 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_dates"
[0m12:48:14.930909 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_dates
[0m12:48:14.992949 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_dates"
[0m12:48:14.994776 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:48:14.996046 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: BEGIN
[0m12:48:14.996901 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:48:15.154138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m12:48:15.154752 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:48:15.155218 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */

  
    

  create  table "Tg_med"."Raw"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH dates AS (
    SELECT
        date::DATE AS date_id,
        EXTRACT(DAY FROM date) AS day,
        EXTRACT(MONTH FROM date) AS month,
        EXTRACT(YEAR FROM date) AS year,
        TO_CHAR(date, 'Day') AS weekday,
        TO_CHAR(date, 'Month') AS month_name
    FROM generate_series(
        '2024-01-01'::DATE,
        CURRENT_DATE,
        INTERVAL '1 day'
    ) AS date
)

SELECT * FROM dates
  );
  
[0m12:48:15.174562 [debug] [Thread-1 (]: SQL status: SELECT 562 in 0.019 seconds
[0m12:48:15.185064 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:48:15.185578 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates" rename to "dim_dates__dbt_backup"
[0m12:48:15.189375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:48:15.192967 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:48:15.193435 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:48:15.194435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:48:15.214532 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m12:48:15.215116 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:48:15.215732 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m12:48:15.217845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:48:15.224226 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."dim_dates__dbt_backup"
[0m12:48:15.230076 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:48:15.230560 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
drop table if exists "Tg_med"."Raw"."dim_dates__dbt_backup" cascade
[0m12:48:15.238950 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m12:48:15.241628 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: Close
[0m12:48:15.245581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022638FFDD90>]}
[0m12:48:15.246692 [info ] [Thread-1 (]: 1 of 5 OK created sql table model Raw.dim_dates ................................ [[32mSELECT 562[0m in 0.32s]
[0m12:48:15.248008 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_dates
[0m12:48:15.248816 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:48:15.249799 [info ] [Thread-1 (]: 2 of 5 START sql table model Raw.fct_image_detections .......................... [RUN]
[0m12:48:15.250538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_dates, now model.telegram_health_insights_pipeline.fct_image_detections)
[0m12:48:15.250985 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:48:15.258509 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:48:15.259700 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:48:15.268350 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:48:15.269576 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:48:15.270064 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: BEGIN
[0m12:48:15.270497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:15.326048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m12:48:15.326936 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:48:15.327650 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */

  
    

  create  table "Tg_med"."Raw"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

select
    message_id, 
    detected_object_class,
    confidence_score
from "Tg_med"."Raw"."raw_image_detection"
  );
  
[0m12:48:15.340015 [debug] [Thread-1 (]: SQL status: SELECT 136 in 0.012 seconds
[0m12:48:15.343424 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:48:15.343866 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
alter table "Tg_med"."Raw"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m12:48:15.345115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:48:15.348749 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: COMMIT
[0m12:48:15.349435 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:48:15.349836 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: COMMIT
[0m12:48:15.352655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:48:15.355329 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."fct_image_detections__dbt_backup"
[0m12:48:15.356131 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:48:15.356549 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
drop table if exists "Tg_med"."Raw"."fct_image_detections__dbt_backup" cascade
[0m12:48:15.357848 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:48:15.359504 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: Close
[0m12:48:15.360251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022638E3DFF0>]}
[0m12:48:15.361436 [info ] [Thread-1 (]: 2 of 5 OK created sql table model Raw.fct_image_detections ..................... [[32mSELECT 136[0m in 0.11s]
[0m12:48:15.363156 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:48:15.363830 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:48:15.364720 [info ] [Thread-1 (]: 3 of 5 START sql view model Raw.stage_tg_messages .............................. [RUN]
[0m12:48:15.365745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.fct_image_detections, now model.telegram_health_insights_pipeline.stage_tg_messages)
[0m12:48:15.366678 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:48:15.369573 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:48:15.371372 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:48:15.399781 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:48:15.402310 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:48:15.402820 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: BEGIN
[0m12:48:15.403233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:15.458832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m12:48:15.459347 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:48:15.459778 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */

  create view "Tg_med"."Raw"."stage_tg_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "Tg_med"."Raw"."raw_telegram_message_data"
),

cleaned as (
    select
        cast(message_id AS BIGINT) AS message_id,
        cast(date as timestamp) as message_timestamp,
        text,
        cast(views as integer) as views,
        cast(forwards as integer) as forwards,
        media
    from source
)

select * from cleaned
  );
[0m12:48:15.470656 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m12:48:15.473942 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:48:15.474387 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages" rename to "stage_tg_messages__dbt_backup"
[0m12:48:15.475401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:48:15.478637 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:48:15.479265 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages__dbt_tmp" rename to "stage_tg_messages"
[0m12:48:15.481178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:48:15.483457 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m12:48:15.484393 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:48:15.484789 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m12:48:15.486830 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:48:15.489220 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."stage_tg_messages__dbt_backup"
[0m12:48:15.492373 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:48:15.492845 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
drop view if exists "Tg_med"."Raw"."stage_tg_messages__dbt_backup" cascade
[0m12:48:15.495453 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:48:15.497065 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: Close
[0m12:48:15.497829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022639524050>]}
[0m12:48:15.499059 [info ] [Thread-1 (]: 3 of 5 OK created sql view model Raw.stage_tg_messages ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:48:15.500300 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:48:15.501506 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_channels
[0m12:48:15.502718 [info ] [Thread-1 (]: 4 of 5 START sql table model Raw.dim_channels .................................. [RUN]
[0m12:48:15.503617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.stage_tg_messages, now model.telegram_health_insights_pipeline.dim_channels)
[0m12:48:15.504184 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_channels
[0m12:48:15.508483 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_channels"
[0m12:48:15.509537 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_channels
[0m12:48:15.514235 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_channels"
[0m12:48:15.515376 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:48:15.515839 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: BEGIN
[0m12:48:15.516224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:15.679630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m12:48:15.680590 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:48:15.681305 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_channels"} */

  
    

  create  table "Tg_med"."Raw"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    channel_name AS channel_display_name
FROM "Tg_med"."Raw"."stage_tg_messages"
WHERE channel_name IS NOT NULL
  );
  
[0m12:48:15.683811 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 15:     channel_name AS channel_display_name
             ^

[0m12:48:15.684297 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: ROLLBACK
[0m12:48:15.685063 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: Close
[0m12:48:15.847907 [debug] [Thread-1 (]: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:48:15.848998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226390D7CD0>]}
[0m12:48:15.849792 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model Raw.dim_channels ......................... [[31mERROR[0m in 0.35s]
[0m12:48:15.850917 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_channels
[0m12:48:15.851440 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_messages
[0m12:48:15.852658 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.dim_channels' to be skipped because of status 'error'.  Reason: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql.
[0m12:48:15.851997 [info ] [Thread-1 (]: 5 of 5 START sql view model Raw.fct_messages ................................... [RUN]
[0m12:48:15.854231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_channels, now model.telegram_health_insights_pipeline.fct_messages)
[0m12:48:15.854733 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_messages
[0m12:48:15.857603 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_messages"
[0m12:48:15.858823 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_messages
[0m12:48:15.863869 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_messages"
[0m12:48:15.865298 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:48:15.866105 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: BEGIN
[0m12:48:15.866852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:16.030010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m12:48:16.030485 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:48:16.030888 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */

  create view "Tg_med"."Raw"."fct_messages__dbt_tmp"
    
    
  as (
    with source as (
    select 
        message_id,
        message_text,
        channel_id,
        date_id
    from "Tg_med"."Raw"."stage_tg_messages"
),

product_extraction as (
    select 
        *,
        -- Extract keyword-based product name
        case 
            when message_text ~* 'paracetamol' then 'paracetamol'
            when message_text ~* 'panadol' then 'panadol'
            when message_text ~* 'ibuprofen' then 'ibuprofen'
            when message_text ~* 'amoxicillin' then 'amoxicillin'
            when message_text ~* 'vitamin' then 'vitamin'
            when message_text ~* 'zinc' then 'zinc'
            when message_text ~* 'antacid' then 'antacid'
            else null
        end as product_name
    from source
)

select * from product_extraction
  );
[0m12:48:16.035834 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "message_text" does not exist
LINE 10:         message_text,
                 ^

[0m12:48:16.036346 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: ROLLBACK
[0m12:48:16.037315 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: Close
[0m12:48:16.047562 [debug] [Thread-1 (]: Database Error in model fct_messages (models\fct_messages.sql)
  column "message_text" does not exist
  LINE 10:         message_text,
                   ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m12:48:16.048824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e3ecd40-a203-41e1-bbeb-2992610ae073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226395A7AF0>]}
[0m12:48:16.050710 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model Raw.fct_messages .......................... [[31mERROR[0m in 0.19s]
[0m12:48:16.051990 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_messages
[0m12:48:16.052919 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models\fct_messages.sql)
  column "message_text" does not exist
  LINE 10:         message_text,
                   ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql.
[0m12:48:16.055170 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:16.055703 [debug] [MainThread]: On master: BEGIN
[0m12:48:16.056063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:16.117040 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m12:48:16.117611 [debug] [MainThread]: On master: COMMIT
[0m12:48:16.118018 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:16.118389 [debug] [MainThread]: On master: COMMIT
[0m12:48:16.118955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:48:16.119373 [debug] [MainThread]: On master: Close
[0m12:48:16.119955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:16.120422 [debug] [MainThread]: Connection 'list_Tg_med' was properly closed.
[0m12:48:16.121036 [debug] [MainThread]: Connection 'list_Tg_med_Raw' was properly closed.
[0m12:48:16.121558 [debug] [MainThread]: Connection 'model.telegram_health_insights_pipeline.fct_messages' was properly closed.
[0m12:48:16.122259 [info ] [MainThread]: 
[0m12:48:16.122980 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 6.28 seconds (6.28s).
[0m12:48:16.125835 [debug] [MainThread]: Command end result
[0m12:48:16.151068 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m12:48:16.153816 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m12:48:16.162361 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\run_results.json
[0m12:48:16.163432 [info ] [MainThread]: 
[0m12:48:16.164286 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:48:16.164892 [info ] [MainThread]: 
[0m12:48:16.166050 [error] [MainThread]: [31mFailure in model dim_channels (models\dim_channels.sql)[0m
[0m12:48:16.167029 [error] [MainThread]:   Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:48:16.167598 [info ] [MainThread]: 
[0m12:48:16.168336 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:48:16.168987 [info ] [MainThread]: 
[0m12:48:16.169681 [error] [MainThread]: [31mFailure in model fct_messages (models\fct_messages.sql)[0m
[0m12:48:16.170302 [error] [MainThread]:   Database Error in model fct_messages (models\fct_messages.sql)
  column "message_text" does not exist
  LINE 10:         message_text,
                   ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m12:48:16.170805 [info ] [MainThread]: 
[0m12:48:16.171640 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\fct_messages.sql
[0m12:48:16.172268 [info ] [MainThread]: 
[0m12:48:16.172718 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m12:48:16.174229 [debug] [MainThread]: Command `dbt run` failed at 12:48:16.174063 after 8.79 seconds
[0m12:48:16.174660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022635CA1D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022638BAB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226395CFDD0>]}
[0m12:48:16.175124 [debug] [MainThread]: Flushing usage events
[0m12:48:17.605109 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:12.049059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA7FB28590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA7D88C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA01C87C50>]}


============================== 12:49:12.058710 | 64f4b519-6645-4dd4-b39c-5f4f1544824c ==============================
[0m12:49:12.058710 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:49:12.059528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:49:12.401720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA7FEF0510>]}
[0m12:49:12.547898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA00BA6140>]}
[0m12:49:12.549649 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:49:12.973086 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:49:13.219285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:13.220774 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\fct_messages.sql
[0m12:49:13.534195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA020D1E50>]}
[0m12:49:13.628232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m12:49:13.631219 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m12:49:13.684295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA01CA2F30>]}
[0m12:49:13.684883 [info ] [MainThread]: Found 5 models, 1 test, 2 sources, 433 macros
[0m12:49:13.685507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA024027B0>]}
[0m12:49:13.689671 [info ] [MainThread]: 
[0m12:49:13.691638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:13.692441 [info ] [MainThread]: 
[0m12:49:13.693234 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:49:13.698553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med'
[0m12:49:13.887134 [debug] [ThreadPool]: Using postgres connection "list_Tg_med"
[0m12:49:13.887695 [debug] [ThreadPool]: On list_Tg_med: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med"} */

    select distinct nspname from pg_namespace
  
[0m12:49:13.888157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:14.050756 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.163 seconds
[0m12:49:14.052326 [debug] [ThreadPool]: On list_Tg_med: Close
[0m12:49:14.055127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med_Raw'
[0m12:49:14.061274 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m12:49:14.061728 [debug] [ThreadPool]: On list_Tg_med_Raw: BEGIN
[0m12:49:14.062058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:14.113484 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m12:49:14.113906 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m12:49:14.114244 [debug] [ThreadPool]: On list_Tg_med_Raw: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med_Raw"} */
select
      'Tg_med' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'Raw'
  
[0m12:49:14.124077 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m12:49:14.125610 [debug] [ThreadPool]: On list_Tg_med_Raw: ROLLBACK
[0m12:49:14.126218 [debug] [ThreadPool]: On list_Tg_med_Raw: Close
[0m12:49:14.132897 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.133348 [debug] [MainThread]: On master: BEGIN
[0m12:49:14.133671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:14.196844 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m12:49:14.197590 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.198274 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:49:14.214671 [debug] [MainThread]: SQL status: SELECT 1 in 0.015 seconds
[0m12:49:14.217391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA025B3D40>]}
[0m12:49:14.218084 [debug] [MainThread]: On master: ROLLBACK
[0m12:49:14.219027 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.219874 [debug] [MainThread]: On master: BEGIN
[0m12:49:14.221055 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:49:14.221647 [debug] [MainThread]: On master: COMMIT
[0m12:49:14.222301 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.222685 [debug] [MainThread]: On master: COMMIT
[0m12:49:14.223261 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:49:14.223679 [debug] [MainThread]: On master: Close
[0m12:49:14.233797 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_dates
[0m12:49:14.234659 [info ] [Thread-1 (]: 1 of 5 START sql table model Raw.dim_dates ..................................... [RUN]
[0m12:49:14.236109 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_health_insights_pipeline.dim_dates'
[0m12:49:14.236931 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_dates
[0m12:49:14.248829 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:14.251404 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_dates
[0m12:49:14.306833 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:14.308295 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:14.308832 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: BEGIN
[0m12:49:14.309248 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:14.364447 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m12:49:14.364956 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:14.365395 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */

  
    

  create  table "Tg_med"."Raw"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH dates AS (
    SELECT
        date::DATE AS date_id,
        EXTRACT(DAY FROM date) AS day,
        EXTRACT(MONTH FROM date) AS month,
        EXTRACT(YEAR FROM date) AS year,
        TO_CHAR(date, 'Day') AS weekday,
        TO_CHAR(date, 'Month') AS month_name
    FROM generate_series(
        '2024-01-01'::DATE,
        CURRENT_DATE,
        INTERVAL '1 day'
    ) AS date
)

SELECT * FROM dates
  );
  
[0m12:49:14.377701 [debug] [Thread-1 (]: SQL status: SELECT 562 in 0.012 seconds
[0m12:49:14.391140 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:14.391721 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates" rename to "dim_dates__dbt_backup"
[0m12:49:14.392913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:49:14.396620 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:14.397467 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:49:14.398646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:49:14.422163 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m12:49:14.422732 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:14.423187 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m12:49:14.425016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:49:14.433727 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."dim_dates__dbt_backup"
[0m12:49:14.442507 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:14.443047 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
drop table if exists "Tg_med"."Raw"."dim_dates__dbt_backup" cascade
[0m12:49:14.447763 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:49:14.450705 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: Close
[0m12:49:14.454758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA02201850>]}
[0m12:49:14.456325 [info ] [Thread-1 (]: 1 of 5 OK created sql table model Raw.dim_dates ................................ [[32mSELECT 562[0m in 0.22s]
[0m12:49:14.458012 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_dates
[0m12:49:14.458540 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:49:14.459146 [info ] [Thread-1 (]: 2 of 5 START sql table model Raw.fct_image_detections .......................... [RUN]
[0m12:49:14.459891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_dates, now model.telegram_health_insights_pipeline.fct_image_detections)
[0m12:49:14.460591 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:49:14.464642 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:14.465919 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:49:14.470425 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:14.471914 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:14.472562 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: BEGIN
[0m12:49:14.473078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:14.539180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m12:49:14.539729 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:14.540185 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */

  
    

  create  table "Tg_med"."Raw"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

select
    message_id, 
    detected_object_class,
    confidence_score
from "Tg_med"."Raw"."raw_image_detection"
  );
  
[0m12:49:14.549787 [debug] [Thread-1 (]: SQL status: SELECT 136 in 0.009 seconds
[0m12:49:14.556364 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:14.557000 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
alter table "Tg_med"."Raw"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m12:49:14.557944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:49:14.562017 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:14.562578 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
alter table "Tg_med"."Raw"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m12:49:14.563658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:49:14.565857 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: COMMIT
[0m12:49:14.566506 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:14.567001 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: COMMIT
[0m12:49:14.569206 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:49:14.572667 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."fct_image_detections__dbt_backup"
[0m12:49:14.573612 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:14.574154 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
drop table if exists "Tg_med"."Raw"."fct_image_detections__dbt_backup" cascade
[0m12:49:14.578976 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:49:14.581041 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: Close
[0m12:49:14.581951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA021FD910>]}
[0m12:49:14.583216 [info ] [Thread-1 (]: 2 of 5 OK created sql table model Raw.fct_image_detections ..................... [[32mSELECT 136[0m in 0.12s]
[0m12:49:14.584713 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:49:14.585987 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:49:14.587186 [info ] [Thread-1 (]: 3 of 5 START sql view model Raw.stage_tg_messages .............................. [RUN]
[0m12:49:14.588517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.fct_image_detections, now model.telegram_health_insights_pipeline.stage_tg_messages)
[0m12:49:14.589245 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:49:14.592267 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:14.593572 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:49:14.621822 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:14.623744 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:14.625705 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: BEGIN
[0m12:49:14.626741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:14.686716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m12:49:14.687965 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:14.688683 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */

  create view "Tg_med"."Raw"."stage_tg_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "Tg_med"."Raw"."raw_telegram_message_data"
),

cleaned as (
    select
        cast(message_id AS BIGINT) AS message_id,
        cast(date as timestamp) as message_timestamp,
        text,
        cast(views as integer) as views,
        cast(forwards as integer) as forwards,
        media
    from source
)

select * from cleaned
  );
[0m12:49:14.694276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:49:14.698901 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:14.699399 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages" rename to "stage_tg_messages__dbt_backup"
[0m12:49:14.700406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:49:14.704263 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:14.704768 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages__dbt_tmp" rename to "stage_tg_messages"
[0m12:49:14.705744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:49:14.707635 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m12:49:14.708133 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:14.708552 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m12:49:14.710023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:49:14.712472 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."stage_tg_messages__dbt_backup"
[0m12:49:14.715851 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:14.716352 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
drop view if exists "Tg_med"."Raw"."stage_tg_messages__dbt_backup" cascade
[0m12:49:14.718202 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:49:14.720204 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: Close
[0m12:49:14.721097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA0221AF30>]}
[0m12:49:14.722490 [info ] [Thread-1 (]: 3 of 5 OK created sql view model Raw.stage_tg_messages ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:49:14.724240 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:49:14.725300 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_channels
[0m12:49:14.725871 [info ] [Thread-1 (]: 4 of 5 START sql table model Raw.dim_channels .................................. [RUN]
[0m12:49:14.726678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.stage_tg_messages, now model.telegram_health_insights_pipeline.dim_channels)
[0m12:49:14.727126 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_channels
[0m12:49:14.730240 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_channels"
[0m12:49:14.731242 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_channels
[0m12:49:14.734502 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_channels"
[0m12:49:14.736167 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:49:14.736713 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: BEGIN
[0m12:49:14.737124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:14.791086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m12:49:14.791595 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:49:14.792028 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_channels"} */

  
    

  create  table "Tg_med"."Raw"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    channel_name AS channel_display_name
FROM "Tg_med"."Raw"."stage_tg_messages"
WHERE channel_name IS NOT NULL
  );
  
[0m12:49:14.793054 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 15:     channel_name AS channel_display_name
             ^

[0m12:49:14.793487 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: ROLLBACK
[0m12:49:14.794146 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: Close
[0m12:49:14.803863 [debug] [Thread-1 (]: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:49:14.804501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA0264F750>]}
[0m12:49:14.805206 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model Raw.dim_channels ......................... [[31mERROR[0m in 0.08s]
[0m12:49:14.806157 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_channels
[0m12:49:14.806639 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_messages
[0m12:49:14.807217 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.dim_channels' to be skipped because of status 'error'.  Reason: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql.
[0m12:49:14.807824 [info ] [Thread-1 (]: 5 of 5 START sql view model Raw.fct_messages ................................... [RUN]
[0m12:49:14.809165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_channels, now model.telegram_health_insights_pipeline.fct_messages)
[0m12:49:14.809609 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_messages
[0m12:49:14.812268 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_messages"
[0m12:49:14.813355 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_messages
[0m12:49:14.817780 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_messages"
[0m12:49:14.820517 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:49:14.821398 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: BEGIN
[0m12:49:14.821995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:14.875884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m12:49:14.876401 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:49:14.876831 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */

  create view "Tg_med"."Raw"."fct_messages__dbt_tmp"
    
    
  as (
    with source as (
    select 
        message_id,
        text,
        channel_id,
        date_id
    from "Tg_med"."Raw"."stage_tg_messages"
),

product_extraction as (
    select 
        *,
        -- Extract keyword-based product name
        case 
            when text ~* 'paracetamol' then 'paracetamol'
            when text ~* 'panadol' then 'panadol'
            when text ~* 'ibuprofen' then 'ibuprofen'
            when text ~* 'amoxicillin' then 'amoxicillin'
            when text ~* 'vitamin' then 'vitamin'
            when text ~* 'zinc' then 'zinc'
            when text ~* 'antacid' then 'antacid'
            else null
        end as product_name
    from source
)

select * from product_extraction
  );
[0m12:49:14.878042 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_id" does not exist
LINE 11:         channel_id,
                 ^

[0m12:49:14.878497 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: ROLLBACK
[0m12:49:14.879159 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: Close
[0m12:49:14.885069 [debug] [Thread-1 (]: Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_id" does not exist
  LINE 11:         channel_id,
                   ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m12:49:14.886066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f4b519-6645-4dd4-b39c-5f4f1544824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA028169E0>]}
[0m12:49:14.886947 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model Raw.fct_messages .......................... [[31mERROR[0m in 0.08s]
[0m12:49:14.888065 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_messages
[0m12:49:14.888830 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_id" does not exist
  LINE 11:         channel_id,
                   ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql.
[0m12:49:14.890787 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.891178 [debug] [MainThread]: On master: BEGIN
[0m12:49:14.891489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:14.945969 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m12:49:14.946649 [debug] [MainThread]: On master: COMMIT
[0m12:49:14.947074 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.947422 [debug] [MainThread]: On master: COMMIT
[0m12:49:14.947991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:49:14.948389 [debug] [MainThread]: On master: Close
[0m12:49:14.948975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:14.949444 [debug] [MainThread]: Connection 'list_Tg_med' was properly closed.
[0m12:49:14.950041 [debug] [MainThread]: Connection 'list_Tg_med_Raw' was properly closed.
[0m12:49:14.950601 [debug] [MainThread]: Connection 'model.telegram_health_insights_pipeline.fct_messages' was properly closed.
[0m12:49:14.951439 [info ] [MainThread]: 
[0m12:49:14.953100 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m12:49:14.955095 [debug] [MainThread]: Command end result
[0m12:49:14.983565 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m12:49:14.988854 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m12:49:14.996650 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\run_results.json
[0m12:49:14.997241 [info ] [MainThread]: 
[0m12:49:14.997891 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:49:14.998407 [info ] [MainThread]: 
[0m12:49:14.998996 [error] [MainThread]: [31mFailure in model dim_channels (models\dim_channels.sql)[0m
[0m12:49:14.999592 [error] [MainThread]:   Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:49:15.000111 [info ] [MainThread]: 
[0m12:49:15.000607 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:49:15.001039 [info ] [MainThread]: 
[0m12:49:15.002878 [error] [MainThread]: [31mFailure in model fct_messages (models\fct_messages.sql)[0m
[0m12:49:15.004300 [error] [MainThread]:   Database Error in model fct_messages (models\fct_messages.sql)
  column "channel_id" does not exist
  LINE 11:         channel_id,
                   ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m12:49:15.005845 [info ] [MainThread]: 
[0m12:49:15.006818 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\fct_messages.sql
[0m12:49:15.007541 [info ] [MainThread]: 
[0m12:49:15.008197 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m12:49:15.010515 [debug] [MainThread]: Command `dbt run` failed at 12:49:15.010293 after 3.16 seconds
[0m12:49:15.011046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA01C74110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA7FE39130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA027A8350>]}
[0m12:49:15.011494 [debug] [MainThread]: Flushing usage events
[0m12:49:16.089347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:34.473803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B126FAC590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B124CB8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1290A7C50>]}


============================== 12:49:34.484748 | 6019d275-09f0-415e-a63a-c512c4b06059 ==============================
[0m12:49:34.484748 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:49:34.485679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:49:34.821973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B127370510>]}
[0m12:49:34.914085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B127FC6140>]}
[0m12:49:34.916815 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:49:35.407926 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:49:35.694992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:35.695741 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\fct_messages.sql
[0m12:49:36.211518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1295D1D50>]}
[0m12:49:36.352802 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m12:49:36.356539 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m12:49:36.423881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1290C2F30>]}
[0m12:49:36.424609 [info ] [MainThread]: Found 5 models, 1 test, 2 sources, 433 macros
[0m12:49:36.425333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B129902890>]}
[0m12:49:36.428031 [info ] [MainThread]: 
[0m12:49:36.428838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:36.429444 [info ] [MainThread]: 
[0m12:49:36.432319 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:49:36.439112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med'
[0m12:49:36.705351 [debug] [ThreadPool]: Using postgres connection "list_Tg_med"
[0m12:49:36.705919 [debug] [ThreadPool]: On list_Tg_med: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med"} */

    select distinct nspname from pg_namespace
  
[0m12:49:36.706353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:36.895259 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.189 seconds
[0m12:49:36.898319 [debug] [ThreadPool]: On list_Tg_med: Close
[0m12:49:36.901219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med_Raw'
[0m12:49:36.909317 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m12:49:36.909938 [debug] [ThreadPool]: On list_Tg_med_Raw: BEGIN
[0m12:49:36.910437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:36.974646 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m12:49:36.975181 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m12:49:36.975637 [debug] [ThreadPool]: On list_Tg_med_Raw: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med_Raw"} */
select
      'Tg_med' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'Raw'
  
[0m12:49:36.985859 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m12:49:36.987638 [debug] [ThreadPool]: On list_Tg_med_Raw: ROLLBACK
[0m12:49:36.988323 [debug] [ThreadPool]: On list_Tg_med_Raw: Close
[0m12:49:36.995167 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:36.995697 [debug] [MainThread]: On master: BEGIN
[0m12:49:36.996617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:37.057030 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m12:49:37.057879 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:37.058740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:49:37.070903 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m12:49:37.072891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B129AA3D40>]}
[0m12:49:37.073425 [debug] [MainThread]: On master: ROLLBACK
[0m12:49:37.074056 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:37.074432 [debug] [MainThread]: On master: BEGIN
[0m12:49:37.075116 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:49:37.075517 [debug] [MainThread]: On master: COMMIT
[0m12:49:37.075874 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:37.076214 [debug] [MainThread]: On master: COMMIT
[0m12:49:37.076724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:49:37.077140 [debug] [MainThread]: On master: Close
[0m12:49:37.087404 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_dates
[0m12:49:37.088293 [info ] [Thread-1 (]: 1 of 5 START sql table model Raw.dim_dates ..................................... [RUN]
[0m12:49:37.089283 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_health_insights_pipeline.dim_dates'
[0m12:49:37.089799 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_dates
[0m12:49:37.099297 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:37.100601 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_dates
[0m12:49:37.167534 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:37.168973 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:37.169549 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: BEGIN
[0m12:49:37.170027 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:37.233917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m12:49:37.234545 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:37.235096 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */

  
    

  create  table "Tg_med"."Raw"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH dates AS (
    SELECT
        date::DATE AS date_id,
        EXTRACT(DAY FROM date) AS day,
        EXTRACT(MONTH FROM date) AS month,
        EXTRACT(YEAR FROM date) AS year,
        TO_CHAR(date, 'Day') AS weekday,
        TO_CHAR(date, 'Month') AS month_name
    FROM generate_series(
        '2024-01-01'::DATE,
        CURRENT_DATE,
        INTERVAL '1 day'
    ) AS date
)

SELECT * FROM dates
  );
  
[0m12:49:37.251067 [debug] [Thread-1 (]: SQL status: SELECT 562 in 0.015 seconds
[0m12:49:37.265459 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:37.266348 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates" rename to "dim_dates__dbt_backup"
[0m12:49:37.267588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:49:37.271826 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:37.272357 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:49:37.273474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:49:37.298974 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m12:49:37.299593 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:37.300080 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m12:49:37.302256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:49:37.311244 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."dim_dates__dbt_backup"
[0m12:49:37.318828 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:49:37.319431 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
drop table if exists "Tg_med"."Raw"."dim_dates__dbt_backup" cascade
[0m12:49:37.324237 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:49:37.327461 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: Close
[0m12:49:37.331781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B129701790>]}
[0m12:49:37.332987 [info ] [Thread-1 (]: 1 of 5 OK created sql table model Raw.dim_dates ................................ [[32mSELECT 562[0m in 0.24s]
[0m12:49:37.334886 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_dates
[0m12:49:37.335749 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:49:37.336706 [info ] [Thread-1 (]: 2 of 5 START sql table model Raw.fct_image_detections .......................... [RUN]
[0m12:49:37.337837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_dates, now model.telegram_health_insights_pipeline.fct_image_detections)
[0m12:49:37.338406 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:49:37.342356 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:37.343541 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:49:37.348302 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:37.349597 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:37.350148 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: BEGIN
[0m12:49:37.350612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:37.418225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m12:49:37.418884 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:37.419414 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */

  
    

  create  table "Tg_med"."Raw"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

select
    message_id, 
    detected_object_class,
    confidence_score
from "Tg_med"."Raw"."raw_image_detection"
  );
  
[0m12:49:37.431396 [debug] [Thread-1 (]: SQL status: SELECT 136 in 0.011 seconds
[0m12:49:37.436100 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:37.436678 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
alter table "Tg_med"."Raw"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m12:49:37.437814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:49:37.441859 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:37.442387 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
alter table "Tg_med"."Raw"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m12:49:37.443502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:49:37.445789 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: COMMIT
[0m12:49:37.446518 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:37.447157 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: COMMIT
[0m12:49:37.449941 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:49:37.453205 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."fct_image_detections__dbt_backup"
[0m12:49:37.454197 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:49:37.454702 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
drop table if exists "Tg_med"."Raw"."fct_image_detections__dbt_backup" cascade
[0m12:49:37.459342 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:49:37.461264 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: Close
[0m12:49:37.462159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1296FD910>]}
[0m12:49:37.463985 [info ] [Thread-1 (]: 2 of 5 OK created sql table model Raw.fct_image_detections ..................... [[32mSELECT 136[0m in 0.12s]
[0m12:49:37.466256 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:49:37.466894 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:49:37.467552 [info ] [Thread-1 (]: 3 of 5 START sql view model Raw.stage_tg_messages .............................. [RUN]
[0m12:49:37.468492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.fct_image_detections, now model.telegram_health_insights_pipeline.stage_tg_messages)
[0m12:49:37.469238 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:49:37.472826 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:37.473989 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:49:37.502368 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:37.503826 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:37.504449 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: BEGIN
[0m12:49:37.504988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:37.565013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m12:49:37.565872 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:37.566749 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */

  create view "Tg_med"."Raw"."stage_tg_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "Tg_med"."Raw"."raw_telegram_message_data"
),

cleaned as (
    select
        cast(message_id AS BIGINT) AS message_id,
        cast(date as timestamp) as message_timestamp,
        text,
        cast(views as integer) as views,
        cast(forwards as integer) as forwards,
        media
    from source
)

select * from cleaned
  );
[0m12:49:37.573720 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:49:37.577663 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:37.578207 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages" rename to "stage_tg_messages__dbt_backup"
[0m12:49:37.579607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:49:37.583580 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:37.584129 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages__dbt_tmp" rename to "stage_tg_messages"
[0m12:49:37.585194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:49:37.587178 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m12:49:37.587700 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:37.588218 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m12:49:37.590088 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:49:37.592910 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."stage_tg_messages__dbt_backup"
[0m12:49:37.597339 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:49:37.597962 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
drop view if exists "Tg_med"."Raw"."stage_tg_messages__dbt_backup" cascade
[0m12:49:37.599961 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:49:37.601710 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: Close
[0m12:49:37.602473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12971AF30>]}
[0m12:49:37.603690 [info ] [Thread-1 (]: 3 of 5 OK created sql view model Raw.stage_tg_messages ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:49:37.605244 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:49:37.606435 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_channels
[0m12:49:37.607238 [info ] [Thread-1 (]: 4 of 5 START sql table model Raw.dim_channels .................................. [RUN]
[0m12:49:37.608195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.stage_tg_messages, now model.telegram_health_insights_pipeline.dim_channels)
[0m12:49:37.608787 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_channels
[0m12:49:37.612784 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_channels"
[0m12:49:37.614096 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_channels
[0m12:49:37.618683 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_channels"
[0m12:49:37.620317 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:49:37.621053 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: BEGIN
[0m12:49:37.621565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:37.794145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.172 seconds
[0m12:49:37.794815 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:49:37.795959 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_channels"} */

  
    

  create  table "Tg_med"."Raw"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    channel_name AS channel_display_name
FROM "Tg_med"."Raw"."stage_tg_messages"
WHERE channel_name IS NOT NULL
  );
  
[0m12:49:37.797860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 15:     channel_name AS channel_display_name
             ^

[0m12:49:37.798799 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: ROLLBACK
[0m12:49:37.799823 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: Close
[0m12:49:37.811246 [debug] [Thread-1 (]: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:49:37.812199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B129B3F750>]}
[0m12:49:37.814140 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model Raw.dim_channels ......................... [[31mERROR[0m in 0.20s]
[0m12:49:37.815622 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_channels
[0m12:49:37.816669 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_messages
[0m12:49:37.817492 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.dim_channels' to be skipped because of status 'error'.  Reason: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql.
[0m12:49:37.818229 [info ] [Thread-1 (]: 5 of 5 START sql view model Raw.fct_messages ................................... [RUN]
[0m12:49:37.823373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_channels, now model.telegram_health_insights_pipeline.fct_messages)
[0m12:49:37.823990 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_messages
[0m12:49:37.827565 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_messages"
[0m12:49:37.829441 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_messages
[0m12:49:37.834581 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_messages"
[0m12:49:37.836397 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:49:37.837076 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: BEGIN
[0m12:49:37.837766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:37.906444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m12:49:37.907521 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:49:37.908278 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */

  create view "Tg_med"."Raw"."fct_messages__dbt_tmp"
    
    
  as (
    with source as (
    select 
        message_id,
        text,
        date_id
    from "Tg_med"."Raw"."stage_tg_messages"
),

product_extraction as (
    select 
        *,
        -- Extract keyword-based product name
        case 
            when text ~* 'paracetamol' then 'paracetamol'
            when text ~* 'panadol' then 'panadol'
            when text ~* 'ibuprofen' then 'ibuprofen'
            when text ~* 'amoxicillin' then 'amoxicillin'
            when text ~* 'vitamin' then 'vitamin'
            when text ~* 'zinc' then 'zinc'
            when text ~* 'antacid' then 'antacid'
            else null
        end as product_name
    from source
)

select * from product_extraction
  );
[0m12:49:37.909686 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date_id" does not exist
LINE 11:         date_id
                 ^

[0m12:49:37.910249 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: ROLLBACK
[0m12:49:37.911014 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: Close
[0m12:49:37.920788 [debug] [Thread-1 (]: Database Error in model fct_messages (models\fct_messages.sql)
  column "date_id" does not exist
  LINE 11:         date_id
                   ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m12:49:37.921557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6019d275-09f0-415e-a63a-c512c4b06059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B129D07540>]}
[0m12:49:37.922412 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model Raw.fct_messages .......................... [[31mERROR[0m in 0.10s]
[0m12:49:37.923452 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_messages
[0m12:49:37.924247 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models\fct_messages.sql)
  column "date_id" does not exist
  LINE 11:         date_id
                   ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql.
[0m12:49:37.925834 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:37.926290 [debug] [MainThread]: On master: BEGIN
[0m12:49:37.926722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:38.110113 [debug] [MainThread]: SQL status: BEGIN in 0.183 seconds
[0m12:49:38.110664 [debug] [MainThread]: On master: COMMIT
[0m12:49:38.111090 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:38.111606 [debug] [MainThread]: On master: COMMIT
[0m12:49:38.112839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:49:38.113482 [debug] [MainThread]: On master: Close
[0m12:49:38.114125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:38.114530 [debug] [MainThread]: Connection 'list_Tg_med' was properly closed.
[0m12:49:38.115192 [debug] [MainThread]: Connection 'list_Tg_med_Raw' was properly closed.
[0m12:49:38.115739 [debug] [MainThread]: Connection 'model.telegram_health_insights_pipeline.fct_messages' was properly closed.
[0m12:49:38.116465 [info ] [MainThread]: 
[0m12:49:38.117449 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m12:49:38.119597 [debug] [MainThread]: Command end result
[0m12:49:38.150980 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m12:49:38.154247 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m12:49:38.162986 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\run_results.json
[0m12:49:38.163823 [info ] [MainThread]: 
[0m12:49:38.165036 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:49:38.166150 [info ] [MainThread]: 
[0m12:49:38.167896 [error] [MainThread]: [31mFailure in model dim_channels (models\dim_channels.sql)[0m
[0m12:49:38.168863 [error] [MainThread]:   Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:49:38.169541 [info ] [MainThread]: 
[0m12:49:38.170279 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:49:38.171244 [info ] [MainThread]: 
[0m12:49:38.172212 [error] [MainThread]: [31mFailure in model fct_messages (models\fct_messages.sql)[0m
[0m12:49:38.172922 [error] [MainThread]:   Database Error in model fct_messages (models\fct_messages.sql)
  column "date_id" does not exist
  LINE 11:         date_id
                   ^
  compiled code at target\run\telegram_health_insights_pipeline\models\fct_messages.sql
[0m12:49:38.173615 [info ] [MainThread]: 
[0m12:49:38.174295 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\fct_messages.sql
[0m12:49:38.174909 [info ] [MainThread]: 
[0m12:49:38.175563 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m12:49:38.177692 [debug] [MainThread]: Command `dbt run` failed at 12:49:38.177465 after 3.90 seconds
[0m12:49:38.178633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1267C9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12955EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B129C8C3B0>]}
[0m12:49:38.179427 [debug] [MainThread]: Flushing usage events
[0m12:49:39.277869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:06.404004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ADE5C590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ABB8C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AFF53C50>]}


============================== 12:50:06.414517 | 3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267 ==============================
[0m12:50:06.414517 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:50:06.415433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:06.730152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AE220510>]}
[0m12:50:06.821585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AFE46140>]}
[0m12:50:06.823589 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:50:07.300334 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:50:07.565265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:50:07.566029 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\fct_messages.sql
[0m12:50:07.929785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B0411D50>]}
[0m12:50:08.037330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m12:50:08.040517 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m12:50:08.093218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AFF6EF30>]}
[0m12:50:08.093858 [info ] [MainThread]: Found 5 models, 1 test, 2 sources, 433 macros
[0m12:50:08.094549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B074E890>]}
[0m12:50:08.096965 [info ] [MainThread]: 
[0m12:50:08.097679 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:08.098995 [info ] [MainThread]: 
[0m12:50:08.100478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:50:08.106108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med'
[0m12:50:08.324158 [debug] [ThreadPool]: Using postgres connection "list_Tg_med"
[0m12:50:08.324920 [debug] [ThreadPool]: On list_Tg_med: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med"} */

    select distinct nspname from pg_namespace
  
[0m12:50:08.325564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:08.496901 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.171 seconds
[0m12:50:08.499387 [debug] [ThreadPool]: On list_Tg_med: Close
[0m12:50:08.502181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med_Raw'
[0m12:50:08.508474 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m12:50:08.508928 [debug] [ThreadPool]: On list_Tg_med_Raw: BEGIN
[0m12:50:08.509290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:08.559608 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m12:50:08.560120 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m12:50:08.560533 [debug] [ThreadPool]: On list_Tg_med_Raw: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med_Raw"} */
select
      'Tg_med' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'Raw'
  
[0m12:50:08.571138 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m12:50:08.573119 [debug] [ThreadPool]: On list_Tg_med_Raw: ROLLBACK
[0m12:50:08.573850 [debug] [ThreadPool]: On list_Tg_med_Raw: Close
[0m12:50:08.582002 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:08.582601 [debug] [MainThread]: On master: BEGIN
[0m12:50:08.583065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:08.643748 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m12:50:08.644294 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:08.644853 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:50:08.658231 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m12:50:08.660265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B08E3D40>]}
[0m12:50:08.660855 [debug] [MainThread]: On master: ROLLBACK
[0m12:50:08.661573 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:08.662031 [debug] [MainThread]: On master: BEGIN
[0m12:50:08.662945 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:50:08.663469 [debug] [MainThread]: On master: COMMIT
[0m12:50:08.664199 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:08.664835 [debug] [MainThread]: On master: COMMIT
[0m12:50:08.665651 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:50:08.666201 [debug] [MainThread]: On master: Close
[0m12:50:08.676677 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_dates
[0m12:50:08.677548 [info ] [Thread-1 (]: 1 of 5 START sql table model Raw.dim_dates ..................................... [RUN]
[0m12:50:08.678639 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_health_insights_pipeline.dim_dates'
[0m12:50:08.679205 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_dates
[0m12:50:08.688474 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_dates"
[0m12:50:08.689810 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_dates
[0m12:50:08.751762 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_dates"
[0m12:50:08.753207 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:50:08.753808 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: BEGIN
[0m12:50:08.754315 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:50:08.812840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m12:50:08.813423 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:50:08.814077 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */

  
    

  create  table "Tg_med"."Raw"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH dates AS (
    SELECT
        date::DATE AS date_id,
        EXTRACT(DAY FROM date) AS day,
        EXTRACT(MONTH FROM date) AS month,
        EXTRACT(YEAR FROM date) AS year,
        TO_CHAR(date, 'Day') AS weekday,
        TO_CHAR(date, 'Month') AS month_name
    FROM generate_series(
        '2024-01-01'::DATE,
        CURRENT_DATE,
        INTERVAL '1 day'
    ) AS date
)

SELECT * FROM dates
  );
  
[0m12:50:08.828980 [debug] [Thread-1 (]: SQL status: SELECT 562 in 0.014 seconds
[0m12:50:08.842614 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:50:08.843199 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates" rename to "dim_dates__dbt_backup"
[0m12:50:08.844257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:08.849134 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:50:08.849737 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:50:08.850834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:08.873831 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m12:50:08.874443 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:50:08.874938 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m12:50:08.876971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:50:08.886595 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."dim_dates__dbt_backup"
[0m12:50:08.893408 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:50:08.893982 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
drop table if exists "Tg_med"."Raw"."dim_dates__dbt_backup" cascade
[0m12:50:08.899892 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:50:08.903202 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: Close
[0m12:50:08.906713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B0541790>]}
[0m12:50:08.908371 [info ] [Thread-1 (]: 1 of 5 OK created sql table model Raw.dim_dates ................................ [[32mSELECT 562[0m in 0.23s]
[0m12:50:08.910158 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_dates
[0m12:50:08.911241 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:50:08.912397 [info ] [Thread-1 (]: 2 of 5 START sql table model Raw.fct_image_detections .......................... [RUN]
[0m12:50:08.913305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_dates, now model.telegram_health_insights_pipeline.fct_image_detections)
[0m12:50:08.914109 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:50:08.918828 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:50:08.920081 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:50:08.924306 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:50:08.925497 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:50:08.926056 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: BEGIN
[0m12:50:08.926628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:08.992478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m12:50:08.993055 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:50:08.993569 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */

  
    

  create  table "Tg_med"."Raw"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

select
    message_id, 
    detected_object_class,
    confidence_score
from "Tg_med"."Raw"."raw_image_detection"
  );
  
[0m12:50:09.006349 [debug] [Thread-1 (]: SQL status: SELECT 136 in 0.012 seconds
[0m12:50:09.010773 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:50:09.011369 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
alter table "Tg_med"."Raw"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m12:50:09.012581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:09.018024 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:50:09.018649 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
alter table "Tg_med"."Raw"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m12:50:09.019879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:09.022157 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: COMMIT
[0m12:50:09.022742 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:50:09.023271 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: COMMIT
[0m12:50:09.025059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:50:09.027963 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."fct_image_detections__dbt_backup"
[0m12:50:09.028942 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:50:09.029451 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
drop table if exists "Tg_med"."Raw"."fct_image_detections__dbt_backup" cascade
[0m12:50:09.035343 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:50:09.037622 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: Close
[0m12:50:09.038483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B053D910>]}
[0m12:50:09.039830 [info ] [Thread-1 (]: 2 of 5 OK created sql table model Raw.fct_image_detections ..................... [[32mSELECT 136[0m in 0.13s]
[0m12:50:09.041789 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:50:09.042913 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:50:09.043802 [info ] [Thread-1 (]: 3 of 5 START sql view model Raw.stage_tg_messages .............................. [RUN]
[0m12:50:09.044670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.fct_image_detections, now model.telegram_health_insights_pipeline.stage_tg_messages)
[0m12:50:09.045220 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:50:09.049278 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:50:09.050576 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:50:09.091971 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:50:09.093908 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:50:09.094748 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: BEGIN
[0m12:50:09.095380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:09.163500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m12:50:09.164398 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:50:09.165017 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */

  create view "Tg_med"."Raw"."stage_tg_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "Tg_med"."Raw"."raw_telegram_message_data"
),

cleaned as (
    select
        cast(message_id AS BIGINT) AS message_id,
        cast(date as timestamp) as message_timestamp,
        text,
        cast(views as integer) as views,
        cast(forwards as integer) as forwards,
        media
    from source
)

select * from cleaned
  );
[0m12:50:09.172827 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:50:09.177911 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:50:09.178608 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages" rename to "stage_tg_messages__dbt_backup"
[0m12:50:09.180035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:09.186096 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:50:09.186831 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages__dbt_tmp" rename to "stage_tg_messages"
[0m12:50:09.188136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:09.190637 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m12:50:09.191394 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:50:09.191958 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m12:50:09.193796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:50:09.197362 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."stage_tg_messages__dbt_backup"
[0m12:50:09.202469 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:50:09.203171 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
drop view if exists "Tg_med"."Raw"."stage_tg_messages__dbt_backup" cascade
[0m12:50:09.205330 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:50:09.207560 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: Close
[0m12:50:09.208606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B055AF30>]}
[0m12:50:09.209994 [info ] [Thread-1 (]: 3 of 5 OK created sql view model Raw.stage_tg_messages ......................... [[32mCREATE VIEW[0m in 0.16s]
[0m12:50:09.211790 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:50:09.213344 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_channels
[0m12:50:09.214799 [info ] [Thread-1 (]: 4 of 5 START sql table model Raw.dim_channels .................................. [RUN]
[0m12:50:09.216023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.stage_tg_messages, now model.telegram_health_insights_pipeline.dim_channels)
[0m12:50:09.217079 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_channels
[0m12:50:09.222169 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_channels"
[0m12:50:09.224183 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_channels
[0m12:50:09.232063 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_channels"
[0m12:50:09.234174 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:50:09.234820 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: BEGIN
[0m12:50:09.235351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:09.303625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m12:50:09.304282 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:50:09.304826 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_channels"} */

  
    

  create  table "Tg_med"."Raw"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    channel_name AS channel_display_name
FROM "Tg_med"."Raw"."stage_tg_messages"
WHERE channel_name IS NOT NULL
  );
  
[0m12:50:09.306135 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 15:     channel_name AS channel_display_name
             ^

[0m12:50:09.306701 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: ROLLBACK
[0m12:50:09.307602 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: Close
[0m12:50:09.319803 [debug] [Thread-1 (]: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:50:09.320549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B097F750>]}
[0m12:50:09.321410 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model Raw.dim_channels ......................... [[31mERROR[0m in 0.10s]
[0m12:50:09.322644 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_channels
[0m12:50:09.323220 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_messages
[0m12:50:09.324601 [debug] [Thread-4 (]: Marking all children of 'model.telegram_health_insights_pipeline.dim_channels' to be skipped because of status 'error'.  Reason: Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql.
[0m12:50:09.323886 [info ] [Thread-1 (]: 5 of 5 START sql view model Raw.fct_messages ................................... [RUN]
[0m12:50:09.326293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_channels, now model.telegram_health_insights_pipeline.fct_messages)
[0m12:50:09.326846 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_messages
[0m12:50:09.330788 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_messages"
[0m12:50:09.333146 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_messages
[0m12:50:09.339493 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_messages"
[0m12:50:09.340895 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:50:09.341511 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: BEGIN
[0m12:50:09.342036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:09.417877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m12:50:09.418884 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:50:09.419705 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */

  create view "Tg_med"."Raw"."fct_messages__dbt_tmp"
    
    
  as (
    with source as (
    select 
        message_id,
        text
    from "Tg_med"."Raw"."stage_tg_messages"
),

product_extraction as (
    select 
        *,
        -- Extract keyword-based product name
        case 
            when text ~* 'paracetamol' then 'paracetamol'
            when text ~* 'panadol' then 'panadol'
            when text ~* 'ibuprofen' then 'ibuprofen'
            when text ~* 'amoxicillin' then 'amoxicillin'
            when text ~* 'vitamin' then 'vitamin'
            when text ~* 'zinc' then 'zinc'
            when text ~* 'antacid' then 'antacid'
            else null
        end as product_name
    from source
)

select * from product_extraction
  );
[0m12:50:09.432609 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m12:50:09.436967 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:50:09.437843 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */
alter table "Tg_med"."Raw"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m12:50:09.439515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:09.441609 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: COMMIT
[0m12:50:09.442167 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:50:09.442697 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: COMMIT
[0m12:50:09.444374 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:50:09.448342 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."fct_messages__dbt_backup"
[0m12:50:09.449454 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:50:09.450005 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */
drop view if exists "Tg_med"."Raw"."fct_messages__dbt_backup" cascade
[0m12:50:09.450897 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:50:09.452781 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: Close
[0m12:50:09.453650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c04b3d1-7c3f-4c3b-a2d1-a05acaa63267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203B0B47EE0>]}
[0m12:50:09.454940 [info ] [Thread-1 (]: 5 of 5 OK created sql view model Raw.fct_messages .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m12:50:09.456254 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_messages
[0m12:50:09.458824 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:09.459779 [debug] [MainThread]: On master: BEGIN
[0m12:50:09.460395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:09.525491 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m12:50:09.526072 [debug] [MainThread]: On master: COMMIT
[0m12:50:09.526551 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:09.526971 [debug] [MainThread]: On master: COMMIT
[0m12:50:09.527652 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:50:09.528135 [debug] [MainThread]: On master: Close
[0m12:50:09.528785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:09.529277 [debug] [MainThread]: Connection 'list_Tg_med' was properly closed.
[0m12:50:09.530371 [debug] [MainThread]: Connection 'list_Tg_med_Raw' was properly closed.
[0m12:50:09.531351 [debug] [MainThread]: Connection 'model.telegram_health_insights_pipeline.fct_messages' was properly closed.
[0m12:50:09.532029 [info ] [MainThread]: 
[0m12:50:09.532838 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m12:50:09.535563 [debug] [MainThread]: Command end result
[0m12:50:09.569401 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m12:50:09.573330 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m12:50:09.585565 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\run_results.json
[0m12:50:09.586204 [info ] [MainThread]: 
[0m12:50:09.587956 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:50:09.594115 [info ] [MainThread]: 
[0m12:50:09.623417 [error] [MainThread]: [31mFailure in model dim_channels (models\dim_channels.sql)[0m
[0m12:50:09.632893 [error] [MainThread]:   Database Error in model dim_channels (models\dim_channels.sql)
  column "channel_name" does not exist
  LINE 15:     channel_name AS channel_display_name
               ^
  compiled code at target\run\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:50:09.635212 [info ] [MainThread]: 
[0m12:50:09.637847 [info ] [MainThread]:   compiled code at target\compiled\telegram_health_insights_pipeline\models\dim_channels.sql
[0m12:50:09.638757 [info ] [MainThread]: 
[0m12:50:09.639614 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m12:50:09.642862 [debug] [MainThread]: Command `dbt run` failed at 12:50:09.642501 after 3.42 seconds
[0m12:50:09.643818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AFE04830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AD68D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AE831F10>]}
[0m12:50:09.645207 [debug] [MainThread]: Flushing usage events
[0m12:50:10.764775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:19.455135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49ACDC590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4989E8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49CDD7C50>]}


============================== 12:54:19.464420 | 993dd833-3351-478c-b4f7-c7fa0a2d934b ==============================
[0m12:54:19.464420 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:54:19.465246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\OneDrive\\Desktop\\Tenx\\telegram-health-insights-pipeline\\src\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:54:19.747783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49B0A0510>]}
[0m12:54:19.830404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49BCF6140>]}
[0m12:54:19.832386 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:20.180302 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:54:20.400535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:54:20.401185 [debug] [MainThread]: Partial parsing: updated file: telegram_health_insights_pipeline://models\stage_tg_messages.sql
[0m12:54:20.729739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49D2B5E50>]}
[0m12:54:20.821669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m12:54:20.825081 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m12:54:20.871198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49CDF2F30>]}
[0m12:54:20.872134 [info ] [MainThread]: Found 5 models, 1 test, 2 sources, 433 macros
[0m12:54:20.872980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49D5E67B0>]}
[0m12:54:20.875790 [info ] [MainThread]: 
[0m12:54:20.876573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:20.877124 [info ] [MainThread]: 
[0m12:54:20.877852 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:20.883057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med'
[0m12:54:21.066084 [debug] [ThreadPool]: Using postgres connection "list_Tg_med"
[0m12:54:21.066594 [debug] [ThreadPool]: On list_Tg_med: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med"} */

    select distinct nspname from pg_namespace
  
[0m12:54:21.066993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:21.225867 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.159 seconds
[0m12:54:21.227764 [debug] [ThreadPool]: On list_Tg_med: Close
[0m12:54:21.230395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Tg_med_Raw'
[0m12:54:21.237322 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m12:54:21.237786 [debug] [ThreadPool]: On list_Tg_med_Raw: BEGIN
[0m12:54:21.238116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:21.286612 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m12:54:21.287385 [debug] [ThreadPool]: Using postgres connection "list_Tg_med_Raw"
[0m12:54:21.287805 [debug] [ThreadPool]: On list_Tg_med_Raw: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "list_Tg_med_Raw"} */
select
      'Tg_med' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Raw'
    union all
    select
      'Tg_med' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'Raw'
  
[0m12:54:21.296251 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m12:54:21.297933 [debug] [ThreadPool]: On list_Tg_med_Raw: ROLLBACK
[0m12:54:21.298563 [debug] [ThreadPool]: On list_Tg_med_Raw: Close
[0m12:54:21.307094 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:21.307588 [debug] [MainThread]: On master: BEGIN
[0m12:54:21.307930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:21.354430 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m12:54:21.354854 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:21.355388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:21.367500 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m12:54:21.369373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49D783AD0>]}
[0m12:54:21.369862 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:21.370437 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:21.370834 [debug] [MainThread]: On master: BEGIN
[0m12:54:21.371582 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:54:21.372133 [debug] [MainThread]: On master: COMMIT
[0m12:54:21.372608 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:21.373069 [debug] [MainThread]: On master: COMMIT
[0m12:54:21.373769 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:54:21.374158 [debug] [MainThread]: On master: Close
[0m12:54:21.382063 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_dates
[0m12:54:21.382726 [info ] [Thread-1 (]: 1 of 5 START sql table model Raw.dim_dates ..................................... [RUN]
[0m12:54:21.383598 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_health_insights_pipeline.dim_dates'
[0m12:54:21.384066 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_dates
[0m12:54:21.391453 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_dates"
[0m12:54:21.392726 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_dates
[0m12:54:21.458375 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_dates"
[0m12:54:21.460122 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:54:21.461066 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: BEGIN
[0m12:54:21.461875 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:21.516420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m12:54:21.516963 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:54:21.517507 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */

  
    

  create  table "Tg_med"."Raw"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH dates AS (
    SELECT
        date::DATE AS date_id,
        EXTRACT(DAY FROM date) AS day,
        EXTRACT(MONTH FROM date) AS month,
        EXTRACT(YEAR FROM date) AS year,
        TO_CHAR(date, 'Day') AS weekday,
        TO_CHAR(date, 'Month') AS month_name
    FROM generate_series(
        '2024-01-01'::DATE,
        CURRENT_DATE,
        INTERVAL '1 day'
    ) AS date
)

SELECT * FROM dates
  );
  
[0m12:54:21.528635 [debug] [Thread-1 (]: SQL status: SELECT 562 in 0.011 seconds
[0m12:54:21.538905 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:54:21.539409 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates" rename to "dim_dates__dbt_backup"
[0m12:54:21.540299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:54:21.543811 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:54:21.544302 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
alter table "Tg_med"."Raw"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:54:21.545192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:54:21.563001 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m12:54:21.563502 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:54:21.563905 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: COMMIT
[0m12:54:21.565528 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:54:21.571978 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."dim_dates__dbt_backup"
[0m12:54:21.577922 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_dates"
[0m12:54:21.578412 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_dates"} */
drop table if exists "Tg_med"."Raw"."dim_dates__dbt_backup" cascade
[0m12:54:21.584372 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:54:21.587137 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_dates: Close
[0m12:54:21.590332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49D3E1850>]}
[0m12:54:21.591368 [info ] [Thread-1 (]: 1 of 5 OK created sql table model Raw.dim_dates ................................ [[32mSELECT 562[0m in 0.20s]
[0m12:54:21.592484 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_dates
[0m12:54:21.593012 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:54:21.593643 [info ] [Thread-1 (]: 2 of 5 START sql table model Raw.fct_image_detections .......................... [RUN]
[0m12:54:21.594337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_dates, now model.telegram_health_insights_pipeline.fct_image_detections)
[0m12:54:21.594789 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:54:21.598068 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:54:21.599085 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:54:21.602511 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:54:21.603531 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:54:21.604483 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: BEGIN
[0m12:54:21.605506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:21.767625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.162 seconds
[0m12:54:21.768143 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:54:21.768552 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */

  
    

  create  table "Tg_med"."Raw"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

select
    message_id, 
    detected_object_class,
    confidence_score
from "Tg_med"."Raw"."raw_image_detection"
  );
  
[0m12:54:21.777419 [debug] [Thread-1 (]: SQL status: SELECT 136 in 0.008 seconds
[0m12:54:21.782602 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:54:21.783359 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
alter table "Tg_med"."Raw"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m12:54:21.784490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:54:21.787948 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:54:21.788432 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
alter table "Tg_med"."Raw"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m12:54:21.789419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:54:21.791221 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: COMMIT
[0m12:54:21.791713 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:54:21.792149 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: COMMIT
[0m12:54:21.795859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:54:21.798218 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."fct_image_detections__dbt_backup"
[0m12:54:21.799043 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_image_detections"
[0m12:54:21.799581 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_image_detections"} */
drop table if exists "Tg_med"."Raw"."fct_image_detections__dbt_backup" cascade
[0m12:54:21.804214 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:54:21.805802 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_image_detections: Close
[0m12:54:21.806517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49D3DD9C0>]}
[0m12:54:21.807365 [info ] [Thread-1 (]: 2 of 5 OK created sql table model Raw.fct_image_detections ..................... [[32mSELECT 136[0m in 0.21s]
[0m12:54:21.808755 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_image_detections
[0m12:54:21.809815 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:54:21.810919 [info ] [Thread-1 (]: 3 of 5 START sql view model Raw.stage_tg_messages .............................. [RUN]
[0m12:54:21.811692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.fct_image_detections, now model.telegram_health_insights_pipeline.stage_tg_messages)
[0m12:54:21.812131 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:54:21.814838 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:54:21.815861 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:54:21.835830 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:54:21.836950 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:54:21.837431 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: BEGIN
[0m12:54:21.837833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:21.893015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m12:54:21.893543 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:54:21.893942 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */

  create view "Tg_med"."Raw"."stage_tg_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "Tg_med"."Raw"."raw_telegram_message_data"
),

cleaned as (
    select
        cast(message_id AS BIGINT) AS message_id,
        channel_name,
        cast(date as timestamp) as message_timestamp,
        text,
        cast(views as integer) as views,
        cast(forwards as integer) as forwards,
        media
    

    from source
)

select * from cleaned
  );
[0m12:54:21.900950 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:54:21.904254 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:54:21.904694 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages" rename to "stage_tg_messages__dbt_backup"
[0m12:54:21.905671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:21.909033 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:54:21.909510 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
alter table "Tg_med"."Raw"."stage_tg_messages__dbt_tmp" rename to "stage_tg_messages"
[0m12:54:21.910471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:21.912132 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m12:54:21.912566 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:54:21.912974 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: COMMIT
[0m12:54:21.917536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:54:21.919972 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."stage_tg_messages__dbt_backup"
[0m12:54:21.922987 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.stage_tg_messages"
[0m12:54:21.923456 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.stage_tg_messages"} */
drop view if exists "Tg_med"."Raw"."stage_tg_messages__dbt_backup" cascade
[0m12:54:21.926103 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:54:21.927668 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.stage_tg_messages: Close
[0m12:54:21.928391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49D3FB2F0>]}
[0m12:54:21.929389 [info ] [Thread-1 (]: 3 of 5 OK created sql view model Raw.stage_tg_messages ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m12:54:21.930737 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.stage_tg_messages
[0m12:54:21.931849 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.dim_channels
[0m12:54:21.932646 [info ] [Thread-1 (]: 4 of 5 START sql table model Raw.dim_channels .................................. [RUN]
[0m12:54:21.933651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.stage_tg_messages, now model.telegram_health_insights_pipeline.dim_channels)
[0m12:54:21.934516 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.dim_channels
[0m12:54:21.938741 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.dim_channels"
[0m12:54:21.939739 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.dim_channels
[0m12:54:21.943157 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.dim_channels"
[0m12:54:21.944202 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:54:21.944644 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: BEGIN
[0m12:54:21.945033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:22.095583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m12:54:22.096102 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:54:22.096548 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_channels"} */

  
    

  create  table "Tg_med"."Raw"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    channel_name AS channel_display_name
FROM "Tg_med"."Raw"."stage_tg_messages"
WHERE channel_name IS NOT NULL
  );
  
[0m12:54:22.103034 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:54:22.106278 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:54:22.106794 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_channels"} */
alter table "Tg_med"."Raw"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m12:54:22.107820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:22.109569 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: COMMIT
[0m12:54:22.110070 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:54:22.110498 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: COMMIT
[0m12:54:22.112242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:54:22.114939 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."dim_channels__dbt_backup"
[0m12:54:22.115748 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.dim_channels"
[0m12:54:22.116167 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.dim_channels"} */
drop table if exists "Tg_med"."Raw"."dim_channels__dbt_backup" cascade
[0m12:54:22.116928 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:54:22.118458 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.dim_channels: Close
[0m12:54:22.119192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49D81F450>]}
[0m12:54:22.120042 [info ] [Thread-1 (]: 4 of 5 OK created sql table model Raw.dim_channels ............................. [[32mSELECT 1[0m in 0.19s]
[0m12:54:22.121152 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.dim_channels
[0m12:54:22.121735 [debug] [Thread-1 (]: Began running node model.telegram_health_insights_pipeline.fct_messages
[0m12:54:22.122453 [info ] [Thread-1 (]: 5 of 5 START sql view model Raw.fct_messages ................................... [RUN]
[0m12:54:22.123282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_health_insights_pipeline.dim_channels, now model.telegram_health_insights_pipeline.fct_messages)
[0m12:54:22.123719 [debug] [Thread-1 (]: Began compiling node model.telegram_health_insights_pipeline.fct_messages
[0m12:54:22.126550 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_health_insights_pipeline.fct_messages"
[0m12:54:22.127611 [debug] [Thread-1 (]: Began executing node model.telegram_health_insights_pipeline.fct_messages
[0m12:54:22.131442 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_health_insights_pipeline.fct_messages"
[0m12:54:22.132518 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:54:22.133005 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: BEGIN
[0m12:54:22.133398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:22.187496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m12:54:22.188036 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:54:22.188487 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */

  create view "Tg_med"."Raw"."fct_messages__dbt_tmp"
    
    
  as (
    with source as (
    select 
        message_id,
        text
    from "Tg_med"."Raw"."stage_tg_messages"
),

product_extraction as (
    select 
        *,
        -- Extract keyword-based product name
        case 
            when text ~* 'paracetamol' then 'paracetamol'
            when text ~* 'panadol' then 'panadol'
            when text ~* 'ibuprofen' then 'ibuprofen'
            when text ~* 'amoxicillin' then 'amoxicillin'
            when text ~* 'vitamin' then 'vitamin'
            when text ~* 'zinc' then 'zinc'
            when text ~* 'antacid' then 'antacid'
            else null
        end as product_name
    from source
)

select * from product_extraction
  );
[0m12:54:22.196977 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:54:22.200355 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:54:22.200800 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */
alter table "Tg_med"."Raw"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m12:54:22.201838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:22.203385 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: COMMIT
[0m12:54:22.203826 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:54:22.204230 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: COMMIT
[0m12:54:22.205998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:54:22.208882 [debug] [Thread-1 (]: Applying DROP to: "Tg_med"."Raw"."fct_messages__dbt_backup"
[0m12:54:22.210218 [debug] [Thread-1 (]: Using postgres connection "model.telegram_health_insights_pipeline.fct_messages"
[0m12:54:22.210653 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "Medical_analysis", "target_name": "dev", "node_id": "model.telegram_health_insights_pipeline.fct_messages"} */
drop view if exists "Tg_med"."Raw"."fct_messages__dbt_backup" cascade
[0m12:54:22.211453 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:54:22.212967 [debug] [Thread-1 (]: On model.telegram_health_insights_pipeline.fct_messages: Close
[0m12:54:22.213659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993dd833-3351-478c-b4f7-c7fa0a2d934b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49D407230>]}
[0m12:54:22.214720 [info ] [Thread-1 (]: 5 of 5 OK created sql view model Raw.fct_messages .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m12:54:22.216051 [debug] [Thread-1 (]: Finished running node model.telegram_health_insights_pipeline.fct_messages
[0m12:54:22.217791 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:22.218387 [debug] [MainThread]: On master: BEGIN
[0m12:54:22.218838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:22.270240 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m12:54:22.270703 [debug] [MainThread]: On master: COMMIT
[0m12:54:22.271072 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:22.271441 [debug] [MainThread]: On master: COMMIT
[0m12:54:22.272018 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:54:22.272405 [debug] [MainThread]: On master: Close
[0m12:54:22.272961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:22.273337 [debug] [MainThread]: Connection 'list_Tg_med' was properly closed.
[0m12:54:22.273792 [debug] [MainThread]: Connection 'list_Tg_med_Raw' was properly closed.
[0m12:54:22.274159 [debug] [MainThread]: Connection 'model.telegram_health_insights_pipeline.fct_messages' was properly closed.
[0m12:54:22.274840 [info ] [MainThread]: 
[0m12:54:22.275905 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m12:54:22.278572 [debug] [MainThread]: Command end result
[0m12:54:22.307066 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\manifest.json
[0m12:54:22.313936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\semantic_manifest.json
[0m12:54:22.321297 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\OneDrive\Desktop\Tenx\telegram-health-insights-pipeline\src\dbt\target\run_results.json
[0m12:54:22.321960 [info ] [MainThread]: 
[0m12:54:22.322829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:22.323625 [info ] [MainThread]: 
[0m12:54:22.324296 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:54:22.327373 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:22.326914 after 3.06 seconds
[0m12:54:22.328046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49CFE9C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49A8E5D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A49B66BD70>]}
[0m12:54:22.328462 [debug] [MainThread]: Flushing usage events
[0m12:54:23.634850 [debug] [MainThread]: An error was encountered while trying to flush usage events
